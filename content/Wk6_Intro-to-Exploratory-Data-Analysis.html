<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dong Ye">

<title>Introduction to Exploratory Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/quarto-html/quarto.js"></script>
<script src="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Wk6_Intro-to-Exploratory-Data-Analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objectives-of-eda" id="toc-objectives-of-eda" class="nav-link active" data-scroll-target="#objectives-of-eda"><span class="toc-section-number">1</span>  Objectives of EDA</a></li>
  <li><a href="#step-0-import-and-read-data" id="toc-step-0-import-and-read-data" class="nav-link" data-scroll-target="#step-0-import-and-read-data"><span class="toc-section-number">2</span>  Step 0: Import and Read Data</a></li>
  <li><a href="#step-1-conduct-data-cleaning" id="toc-step-1-conduct-data-cleaning" class="nav-link" data-scroll-target="#step-1-conduct-data-cleaning"><span class="toc-section-number">3</span>  Step 1: Conduct Data Cleaning</a></li>
  <li><a href="#step-2-univariate-analysis" id="toc-step-2-univariate-analysis" class="nav-link" data-scroll-target="#step-2-univariate-analysis"><span class="toc-section-number">4</span>  Step 2: Univariate Analysis</a></li>
  <li><a href="#step-3-bivariate-analysis" id="toc-step-3-bivariate-analysis" class="nav-link" data-scroll-target="#step-3-bivariate-analysis"><span class="toc-section-number">5</span>  Step 3: Bivariate Analysis</a></li>
  <li><a href="#ask-a-question-about-the-data" id="toc-ask-a-question-about-the-data" class="nav-link" data-scroll-target="#ask-a-question-about-the-data"><span class="toc-section-number">6</span>  Ask a Question about the data</a></li>
  <li><a href="#step-4-multivariate-analysis" id="toc-step-4-multivariate-analysis" class="nav-link" data-scroll-target="#step-4-multivariate-analysis"><span class="toc-section-number">7</span>  Step 4: Multivariate Analysis</a>
  <ul class="collapse">
  <li><a href="#review-step-0-3" id="toc-review-step-0-3" class="nav-link" data-scroll-target="#review-step-0-3"><span class="toc-section-number">7.1</span>  Review Step 0-3</a></li>
  </ul></li>
  <li><a href="#step-5-data-visualization" id="toc-step-5-data-visualization" class="nav-link" data-scroll-target="#step-5-data-visualization"><span class="toc-section-number">8</span>  Step 5: Data Visualization</a></li>
  <li><a href="#step-6-modeling" id="toc-step-6-modeling" class="nav-link" data-scroll-target="#step-6-modeling"><span class="toc-section-number">9</span>  Step 6: Modeling</a>
  <ul class="collapse">
  <li><a href="#feature-selection" id="toc-feature-selection" class="nav-link" data-scroll-target="#feature-selection"><span class="toc-section-number">9.1</span>  Feature Selection</a></li>
  <li><a href="#model-selection" id="toc-model-selection" class="nav-link" data-scroll-target="#model-selection"><span class="toc-section-number">9.2</span>  Model Selection</a></li>
  <li><a href="#prediction-model" id="toc-prediction-model" class="nav-link" data-scroll-target="#prediction-model"><span class="toc-section-number">9.3</span>  Prediction Model</a></li>
  </ul></li>
  <li><a href="#titanic-case" id="toc-titanic-case" class="nav-link" data-scroll-target="#titanic-case"><span class="toc-section-number">10</span>  Titanic Case</a></li>
  <li><a href="#absent-from-work" id="toc-absent-from-work" class="nav-link" data-scroll-target="#absent-from-work"><span class="toc-section-number">11</span>  Absent from Work</a>
  <ul class="collapse">
  <li><a href="#import-and-read-data" id="toc-import-and-read-data" class="nav-link" data-scroll-target="#import-and-read-data"><span class="toc-section-number">11.1</span>  0 Import and Read Data</a></li>
  <li><a href="#clean-data" id="toc-clean-data" class="nav-link" data-scroll-target="#clean-data"><span class="toc-section-number">11.2</span>  1 Clean Data</a></li>
  <li><a href="#univariate-analysis" id="toc-univariate-analysis" class="nav-link" data-scroll-target="#univariate-analysis"><span class="toc-section-number">11.3</span>  2 Univariate Analysis</a></li>
  <li><a href="#multivariate-analysis" id="toc-multivariate-analysis" class="nav-link" data-scroll-target="#multivariate-analysis"><span class="toc-section-number">11.4</span>  3 Multivariate Analysis</a></li>
  <li><a href="#visualize-data" id="toc-visualize-data" class="nav-link" data-scroll-target="#visualize-data"><span class="toc-section-number">11.5</span>  5 Visualize Data</a></li>
  <li><a href="#prediction-model-1" id="toc-prediction-model-1" class="nav-link" data-scroll-target="#prediction-model-1"><span class="toc-section-number">11.6</span>  6 Prediction Model</a></li>
  </ul></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="toc-section-number">12</span>  Resources</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Introduction to Exploratory Data Analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dong Ye </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>Exploratory Data Analysis (EDA) is an approach to analyzing and summarizing datasets, with the primary goal of discovering patterns, relationships, and insights that may not be immediately apparent. EDA is often the first step in the data analysis process and is crucial in generating hypotheses and developing a deeper understanding of the data before building predictive models or making conclusions.</p>
<p>In EDA, you may use a variety of techniques such as plotting histograms, scatter plots, box plots, and other graphical representations to visualize the distribution and relationships between variables. You might also use summary statistics such as mean, median, and standard deviation to describe the central tendency and dispersion of the data.</p>
<p>The main objective of EDA is to understand the underlying structure of the data, identify outliers, detect anomalies, and gain insights that can inform the development of more advanced models and methods.</p>
<p>Several questions come to mind when we come across a new dataset. The below list shed light on some of these questions:-</p>
<p>• What is the distribution of the dataset?</p>
<p>• Are there any missing numerical values, outliers or anomalies in the dataset?</p>
<p>• What are the underlying assumptions in the dataset?</p>
<p>• Whether there exists relationships between variables in the dataset?</p>
<p>• How to be sure that our dataset is ready for input in a machine learning algorithm?</p>
<p>• How to select the most suitable algorithm for a given dataset?</p>
<section id="objectives-of-eda" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="objectives-of-eda"><span class="header-section-number">1</span> Objectives of EDA</h2>
<p>The objectives of the EDA are as follows:-</p>
<ol type="i">
<li><p>To get an overview of the distribution of the dataset.</p></li>
<li><p>Check for missing numerical values, outliers or other anomalies in the dataset.</p></li>
<li><p>Discover patterns and relationships between variables in the dataset.</p></li>
<li><p>Check the underlying assumptions in the dataset.</p></li>
</ol>
</section>
<section id="step-0-import-and-read-data" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="step-0-import-and-read-data"><span class="header-section-number">2</span> Step 0: Import and Read Data</h2>
<pre><code>    Install the libraries.
    Import the libararies and Modules.
    Import and read the dataset(s).</code></pre>
<p><strong>Import the required Python libraries</strong></p>
<p>We need two Python libraries for exploratory data analysis – NumPy and Pandas.</p>
<p>• NumPy – NumPy is the fundamental Python library for scientific computing. It adds support for large and multi-dimensional arrays and matrices. It also supports large collection of high-level mathematical functions to operate on these arrays.</p>
<p>• Pandas - Pandas is a software library for Python programming language which provide tools for data manipulation and analysis tasks. It will enable us to manipulate numerical tables and time series using data structures and operations.</p>
<p>We need two more libraries for data visualization purpose. These are Seaborn and Matplotlib.</p>
<p>• Seaborn - Seaborn is a Python data visualization library based on Matplotlib. It provides a high level interface for drawing attractive and informative statistical graphics.</p>
<p>• Matplotlib - Matplotlib is the core data visualization library of Python programming language. It provides an object-oriented API for embedding plots into applications.</p>
<p>We need to import these libraries before we actually start using them. We can import them with their usual shorthand notation as follows:</p>
<div class="cell" data-execution_count="161">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore the warnings</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(action <span class="op">=</span> <span class="st">"ignore"</span>, category <span class="op">=</span> <span class="pp">FutureWarning</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This code is used to suppress warnings generated by the Python interpreter. The warnings module provides a way to raise warnings and to control the reporting of warnings.</p>
<p>The simplefilter method is used to ignore warnings that have a certain category. In this case, the FutureWarning category is being ignored. This is often used when you are aware of a deprecation in a library you are using and want to temporarily suppress the warning messages.</p>
<p>::: {.cell _cell_guid=‘b1076dfc-b9ad-4769-8c92-a6c4dae69d19’ _uuid=‘8f2839f25d086af736a60e9eeb907d3b93b6e0e5’ papermill=‘{“duration”:0.950081,“end_time”:“2021-12-31T22:25:24.521694”,“exception”:false,“start_time”:“2021-12-31T22:25:23.571613”,“status”:“completed”}’ tags=‘[]’}</p>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p>:::</p>
<p>The %matplotlib inline is a Jupyter magic command that is used to display the plots generated by Matplotlib in the output cells of the Jupyter notebook.</p>
<p>It is a convenience command that allows you to quickly visualize the plots within the notebook, without having to manually call plt.show(). The %matplotlib inline command must be executed before any plotting is done in order to display the plots within the notebook.</p>
<p>Note that this command is specific to Jupyter notebooks and is not a standard part of the Python programming language.</p>
<div class="cell" data-execution_count="163">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The sns.set(style=“whitegrid”) line is a command from the Seaborn library, a popular data visualization library based on Matplotlib.</p>
<p>The sns.set() function is used to set the style of the plots generated by Seaborn. The style parameter takes a string argument that specifies the style to use.</p>
<p>In this case, the argument is “whitegrid”, which sets the style of the plots to a white background with an overlaid grid. Seaborn provides several pre-defined styles that can be used to quickly change the look and feel of your plots.</p>
<p>By setting the style using the sns.set() function, you can ensure a consistent look and feel for all of your plots in a project.</p>
<div class="cell" data-execution_count="164">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> ExtraTreesClassifier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.070227,&quot;end_time&quot;:&quot;2021-12-31T22:25:24.611069&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:24.540842&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="165">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/Dong2Yo/Dataset/main/coaster.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Dataframe <code>shape</code></li>
<li><code>head</code> and <code>tail</code></li>
<li><code>dtypes</code></li>
<li><code>describe</code></li>
</ul>
<div class="cell" data-papermill="{&quot;duration&quot;:0.029721,&quot;end_time&quot;:&quot;2021-12-31T22:25:24.716333&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:24.686612&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="166">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="166">
<pre><code>(1087, 56)</code></pre>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.068471,&quot;end_time&quot;:&quot;2021-12-31T22:25:24.805357&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:24.736886&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="167">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="167">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>coaster_name</th>
      <th>Length</th>
      <th>Speed</th>
      <th>Location</th>
      <th>Status</th>
      <th>Opening date</th>
      <th>Type</th>
      <th>Manufacturer</th>
      <th>Height restriction</th>
      <th>Model</th>
      <th>...</th>
      <th>speed1</th>
      <th>speed2</th>
      <th>speed1_value</th>
      <th>speed1_unit</th>
      <th>speed_mph</th>
      <th>height_value</th>
      <th>height_unit</th>
      <th>height_ft</th>
      <th>Inversions_clean</th>
      <th>Gforce_clean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Switchback Railway</td>
      <td>600&nbsp;ft (180&nbsp;m)</td>
      <td>6 mph (9.7 km/h)</td>
      <td>Coney Island</td>
      <td>Removed</td>
      <td>June&nbsp;16,&nbsp;1884</td>
      <td>Wood</td>
      <td>LaMarcus Adna Thompson</td>
      <td>NaN</td>
      <td>Lift Packed</td>
      <td>...</td>
      <td>6 mph</td>
      <td>9.7 km/h</td>
      <td>6.0</td>
      <td>mph</td>
      <td>6.0</td>
      <td>50.0</td>
      <td>ft</td>
      <td>NaN</td>
      <td>0</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Flip Flap Railway</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sea Lion Park</td>
      <td>Removed</td>
      <td>1895</td>
      <td>Wood</td>
      <td>Lina Beecher</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Switchback Railway (Euclid Beach Park)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Cleveland, Ohio, United States</td>
      <td>Closed</td>
      <td>NaN</td>
      <td>Other</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Loop the Loop (Coney Island)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Other</td>
      <td>Removed</td>
      <td>1901</td>
      <td>Steel</td>
      <td>Edwin Prescott</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Loop the Loop (Young's Pier)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Other</td>
      <td>Removed</td>
      <td>1901</td>
      <td>Steel</td>
      <td>Edwin Prescott</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 56 columns</p>
</div>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.028414,&quot;end_time&quot;:&quot;2021-12-31T22:25:24.854178&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:24.825764&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="168">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="168">
<pre><code>Index(['coaster_name', 'Length', 'Speed', 'Location', 'Status', 'Opening date',
       'Type', 'Manufacturer', 'Height restriction', 'Model', 'Height',
       'Inversions', 'Lift/launch system', 'Cost', 'Trains', 'Park section',
       'Duration', 'Capacity', 'G-force', 'Designer', 'Max vertical angle',
       'Drop', 'Soft opening date', 'Fast Lane available', 'Replaced',
       'Track layout', 'Fastrack available', 'Soft opening date.1',
       'Closing date', 'Opened', 'Replaced by', 'Website',
       'Flash Pass Available', 'Must transfer from wheelchair', 'Theme',
       'Single rider line available', 'Restraint Style',
       'Flash Pass available', 'Acceleration', 'Restraints', 'Name',
       'year_introduced', 'latitude', 'longitude', 'Type_Main',
       'opening_date_clean', 'speed1', 'speed2', 'speed1_value', 'speed1_unit',
       'speed_mph', 'height_value', 'height_unit', 'height_ft',
       'Inversions_clean', 'Gforce_clean'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.030131,&quot;end_time&quot;:&quot;2021-12-31T22:25:24.904578&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:24.874447&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="169">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="169">
<pre><code>coaster_name                      object
Length                            object
Speed                             object
Location                          object
Status                            object
Opening date                      object
Type                              object
Manufacturer                      object
Height restriction                object
Model                             object
Height                            object
Inversions                       float64
Lift/launch system                object
Cost                              object
Trains                            object
Park section                      object
Duration                          object
Capacity                          object
G-force                           object
Designer                          object
Max vertical angle                object
Drop                              object
Soft opening date                 object
Fast Lane available               object
Replaced                          object
Track layout                      object
Fastrack available                object
Soft opening date.1               object
Closing date                      object
Opened                            object
Replaced by                       object
Website                           object
Flash Pass Available              object
Must transfer from wheelchair     object
Theme                             object
Single rider line available       object
Restraint Style                   object
Flash Pass available              object
Acceleration                      object
Restraints                        object
Name                              object
year_introduced                    int64
latitude                         float64
longitude                        float64
Type_Main                         object
opening_date_clean                object
speed1                            object
speed2                            object
speed1_value                     float64
speed1_unit                       object
speed_mph                        float64
height_value                     float64
height_unit                       object
height_ft                        float64
Inversions_clean                   int64
Gforce_clean                     float64
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.065671,&quot;end_time&quot;:&quot;2021-12-31T22:25:24.991200&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:24.925529&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="170">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="170">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Inversions</th>
      <th>year_introduced</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>speed1_value</th>
      <th>speed_mph</th>
      <th>height_value</th>
      <th>height_ft</th>
      <th>Inversions_clean</th>
      <th>Gforce_clean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>932.000000</td>
      <td>1087.000000</td>
      <td>812.000000</td>
      <td>812.000000</td>
      <td>937.000000</td>
      <td>937.000000</td>
      <td>965.000000</td>
      <td>171.000000</td>
      <td>1087.000000</td>
      <td>362.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.547210</td>
      <td>1994.986201</td>
      <td>38.373484</td>
      <td>-41.595373</td>
      <td>53.850374</td>
      <td>48.617289</td>
      <td>89.575171</td>
      <td>101.996491</td>
      <td>1.326587</td>
      <td>3.824006</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.114073</td>
      <td>23.475248</td>
      <td>15.516596</td>
      <td>72.285227</td>
      <td>23.385518</td>
      <td>16.678031</td>
      <td>136.246444</td>
      <td>67.329092</td>
      <td>2.030854</td>
      <td>0.989998</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1884.000000</td>
      <td>-48.261700</td>
      <td>-123.035700</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>4.000000</td>
      <td>13.100000</td>
      <td>0.000000</td>
      <td>0.800000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>1989.000000</td>
      <td>35.031050</td>
      <td>-84.552200</td>
      <td>40.000000</td>
      <td>37.300000</td>
      <td>44.000000</td>
      <td>51.800000</td>
      <td>0.000000</td>
      <td>3.400000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>2000.000000</td>
      <td>40.289800</td>
      <td>-76.653600</td>
      <td>50.000000</td>
      <td>49.700000</td>
      <td>79.000000</td>
      <td>91.200000</td>
      <td>0.000000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.000000</td>
      <td>2010.000000</td>
      <td>44.799600</td>
      <td>2.778100</td>
      <td>63.000000</td>
      <td>58.000000</td>
      <td>113.000000</td>
      <td>131.200000</td>
      <td>2.000000</td>
      <td>4.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>14.000000</td>
      <td>2022.000000</td>
      <td>63.230900</td>
      <td>153.426500</td>
      <td>240.000000</td>
      <td>149.100000</td>
      <td>3937.000000</td>
      <td>377.300000</td>
      <td>14.000000</td>
      <td>12.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="171">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1087 entries, 0 to 1086
Data columns (total 56 columns):
 #   Column                         Non-Null Count  Dtype  
---  ------                         --------------  -----  
 0   coaster_name                   1087 non-null   object 
 1   Length                         953 non-null    object 
 2   Speed                          937 non-null    object 
 3   Location                       1087 non-null   object 
 4   Status                         874 non-null    object 
 5   Opening date                   837 non-null    object 
 6   Type                           1087 non-null   object 
 7   Manufacturer                   1028 non-null   object 
 8   Height restriction             831 non-null    object 
 9   Model                          744 non-null    object 
 10  Height                         965 non-null    object 
 11  Inversions                     932 non-null    float64
 12  Lift/launch system             795 non-null    object 
 13  Cost                           382 non-null    object 
 14  Trains                         718 non-null    object 
 15  Park section                   487 non-null    object 
 16  Duration                       765 non-null    object 
 17  Capacity                       575 non-null    object 
 18  G-force                        362 non-null    object 
 19  Designer                       578 non-null    object 
 20  Max vertical angle             357 non-null    object 
 21  Drop                           494 non-null    object 
 22  Soft opening date              96 non-null     object 
 23  Fast Lane available            69 non-null     object 
 24  Replaced                       173 non-null    object 
 25  Track layout                   335 non-null    object 
 26  Fastrack available             19 non-null     object 
 27  Soft opening date.1            96 non-null     object 
 28  Closing date                   236 non-null    object 
 29  Opened                         27 non-null     object 
 30  Replaced by                    88 non-null     object 
 31  Website                        87 non-null     object 
 32  Flash Pass Available           50 non-null     object 
 33  Must transfer from wheelchair  106 non-null    object 
 34  Theme                          44 non-null     object 
 35  Single rider line available    81 non-null     object 
 36  Restraint Style                22 non-null     object 
 37  Flash Pass available           46 non-null     object 
 38  Acceleration                   60 non-null     object 
 39  Restraints                     24 non-null     object 
 40  Name                           35 non-null     object 
 41  year_introduced                1087 non-null   int64  
 42  latitude                       812 non-null    float64
 43  longitude                      812 non-null    float64
 44  Type_Main                      1087 non-null   object 
 45  opening_date_clean             837 non-null    object 
 46  speed1                         937 non-null    object 
 47  speed2                         935 non-null    object 
 48  speed1_value                   937 non-null    float64
 49  speed1_unit                    937 non-null    object 
 50  speed_mph                      937 non-null    float64
 51  height_value                   965 non-null    float64
 52  height_unit                    965 non-null    object 
 53  height_ft                      171 non-null    float64
 54  Inversions_clean               1087 non-null   int64  
 55  Gforce_clean                   362 non-null    float64
dtypes: float64(8), int64(2), object(46)
memory usage: 475.7+ KB</code></pre>
</div>
</div>
</section>
<section id="step-1-conduct-data-cleaning" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="step-1-conduct-data-cleaning"><span class="header-section-number">3</span> Step 1: Conduct Data Cleaning</h2>
<p>The first step in EDA is to clean and pre-process the data. This involves checking for missing values, correcting inconsistent data, handling outliers, and transforming variables as necessary.</p>
<p>Some of the questions we will ask ourselves are</p>
<pre><code>* Are there any useless or redundant variables?
* Are there any duplicate columns?
* Does the nomenclature make sense?
* Are there any new variables we want to create?</code></pre>
<p>During this step, we might perform the following tasks:</p>
<pre><code>1. Check for missing values: We would look for any rows in the dataset that contain missing values and determine how to handle them. For example, we might decide to remove rows with missing values or impute missing values using the mean or median of the data.

2. Correct inconsistent data: We would check for any inconsistencies in the data, such as incorrect data types or incorrect values. For example, we might find that the number of bedrooms or bathrooms is recorded as a string instead of a numerical value. We would need to correct these inconsistencies to make the data suitable for analysis.

3. Handle outliers: We would look for any outliers in the data and determine how to handle them. For example, we might decide to remove any homes with extremely high or low sale prices, as these homes may not be representative of the typical market.

4. Transform variables: We might also decide to transform some of the variables, such as converting square footage from square feet to square meters. This could help to standardize the data and make it easier to compare variables.</code></pre>
<p>These are just a few examples of tasks that might be performed during the data cleaning step of EDA. The specific tasks performed will depend on the dataset and the goals of the analysis.</p>
<div class="cell" data-execution_count="172">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>coaster_name                        0
Length                            134
Speed                             150
Location                            0
Status                            213
Opening date                      250
Type                                0
Manufacturer                       59
Height restriction                256
Model                             343
Height                            122
Inversions                        155
Lift/launch system                292
Cost                              705
Trains                            369
Park section                      600
Duration                          322
Capacity                          512
G-force                           725
Designer                          509
Max vertical angle                730
Drop                              593
Soft opening date                 991
Fast Lane available              1018
Replaced                          914
Track layout                      752
Fastrack available               1068
Soft opening date.1               991
Closing date                      851
Opened                           1060
Replaced by                       999
Website                          1000
Flash Pass Available             1037
Must transfer from wheelchair     981
Theme                            1043
Single rider line available      1006
Restraint Style                  1065
Flash Pass available             1041
Acceleration                     1027
Restraints                       1063
Name                             1052
year_introduced                     0
latitude                          275
longitude                         275
Type_Main                           0
opening_date_clean                250
speed1                            150
speed2                            152
speed1_value                      150
speed1_unit                       150
speed_mph                         150
height_value                      122
height_unit                       122
height_ft                         916
Inversions_clean                    0
Gforce_clean                      725
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.030091,&quot;end_time&quot;:&quot;2021-12-31T22:25:25.093436&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:25.063345&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="173">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of dropping columns</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df.drop(['Opening date'], axis=1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.035435,&quot;end_time&quot;:&quot;2021-12-31T22:25:25.152317&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:25.116882&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="174">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df[[<span class="st">'coaster_name'</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 'Length', 'Speed',</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Location'</span>, <span class="st">'Status'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 'Opening date',</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   'Type',</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Manufacturer'</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Height restriction', 'Model', 'Height',</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Inversions', 'Lift/launch system', 'Cost', 'Trains', 'Park section',</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Duration', 'Capacity', 'G-force', 'Designer', 'Max vertical angle',</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Drop', 'Soft opening date', 'Fast Lane available', 'Replaced',</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Track layout', 'Fastrack available', 'Soft opening date.1',</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Closing date',</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Opened', </span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 'Replaced by', 'Website',</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Flash Pass Available', 'Must transfer from wheelchair', 'Theme',</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Single rider line available', 'Restraint Style',</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#        'Flash Pass available', 'Acceleration', 'Restraints', 'Name',</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>       <span class="st">'year_introduced'</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'latitude'</span>, <span class="st">'longitude'</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Type_Main'</span>,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>       <span class="st">'opening_date_clean'</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'speed1', 'speed2', 'speed1_value', 'speed1_unit',</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>       <span class="st">'speed_mph'</span>, </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#'height_value', 'height_unit',</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'height_ft'</span>,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>       <span class="st">'Inversions_clean'</span>, <span class="st">'Gforce_clean'</span>]].copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>converting a column in a pandas DataFrame from a string representation of a date/time to a pandas datetime object.</p>
<p>To find the data type of a single variable in a pandas DataFrame, you can use the dtype attribute of the corresponding column. For example, if you have a DataFrame df and you want to find the data type of the column “column_name”, you can do the following:</p>
<div class="cell" data-papermill="{&quot;duration&quot;:0.030131,&quot;end_time&quot;:&quot;2021-12-31T22:25:24.904578&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:24.874447&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="175">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_type <span class="op">=</span> df2[<span class="st">'opening_date_clean'</span>].dtype</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>object</code></pre>
</div>
</div>
<p>This will print the data type of the column “column_name” in the DataFrame df. The data type could be one of several types, including int64, float64, object, or datetime64, among others. You can use this information to determine if the data in a particular column needs to be transformed or if there are any inconsistencies in the data that need to be corrected.</p>
<div class="cell" data-execution_count="176">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">'opening_date_clean'</span>] <span class="op">=</span> pd.to_datetime(df2[<span class="st">'opening_date_clean'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.030131,&quot;end_time&quot;:&quot;2021-12-31T22:25:24.904578&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:24.874447&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="177">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="178">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename our columns</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df2.rename(columns<span class="op">=</span>{<span class="st">'coaster_name'</span>:<span class="st">'Coaster_Name'</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'year_introduced'</span>:<span class="st">'Year_Introduced'</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'opening_date_clean'</span>:<span class="st">'Opening_Date'</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'speed_mph'</span>:<span class="st">'Speed_mph'</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'height_ft'</span>:<span class="st">'Height_ft'</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'Inversions_clean'</span>:<span class="st">'Inversions'</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'Gforce_clean'</span>:<span class="st">'Gforce'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="179">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of missing values (NaN values) in each column of a pandas DataFrame</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df3.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>Coaster_Name         0
Location             0
Status             213
Manufacturer        59
Year_Introduced      0
latitude           275
longitude          275
Type_Main            0
Opening_Date       250
Speed_mph          150
Height_ft          916
Inversions           0
Gforce             725
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="180">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle missing values by imputing the mean value for each column</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># works with numbers</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = df.fillna(df.mean())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The df.duplicated() method returns a boolean array indicating whether each row in the DataFrame is a duplicate of a previous row. True indicates that a row is a duplicate, and False indicates that a row is not a duplicate.</p>
<p>The df.loc method is then used to filter the original DataFrame df based on the boolean array returned by df.duplicated(). Specifically, df.loc[df.duplicated()] returns the rows where the value is True, meaning that those rows are duplicates.</p>
<p>The output of this code will be a new DataFrame containing only the rows that are duplicates in the original DataFrame. This information can be useful in identifying and removing duplicates from the data to ensure the accuracy of your analysis.</p>
<div class="cell" data-execution_count="181">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df3.loc[df3.duplicated()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="181">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Coaster_Name</th>
      <th>Location</th>
      <th>Status</th>
      <th>Manufacturer</th>
      <th>Year_Introduced</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Type_Main</th>
      <th>Opening_Date</th>
      <th>Speed_mph</th>
      <th>Height_ft</th>
      <th>Inversions</th>
      <th>Gforce</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="182">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for duplicate coaster name</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df3.loc[df3.duplicated(subset<span class="op">=</span>[<span class="st">'Coaster_Name'</span>])].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="182">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Coaster_Name</th>
      <th>Location</th>
      <th>Status</th>
      <th>Manufacturer</th>
      <th>Year_Introduced</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Type_Main</th>
      <th>Opening_Date</th>
      <th>Speed_mph</th>
      <th>Height_ft</th>
      <th>Inversions</th>
      <th>Gforce</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>43</th>
      <td>Crystal Beach Cyclone</td>
      <td>Crystal Beach Park</td>
      <td>Removed</td>
      <td>Traver Engineering</td>
      <td>1927</td>
      <td>42.8617</td>
      <td>-79.0598</td>
      <td>Wood</td>
      <td>1926-01-01</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Derby Racer</td>
      <td>Revere Beach</td>
      <td>Removed</td>
      <td>Fred W. Pearce</td>
      <td>1937</td>
      <td>42.4200</td>
      <td>-70.9860</td>
      <td>Wood</td>
      <td>1911-01-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Blue Streak (Conneaut Lake)</td>
      <td>Conneaut Lake Park</td>
      <td>Closed</td>
      <td>NaN</td>
      <td>1938</td>
      <td>41.6349</td>
      <td>-80.3180</td>
      <td>Wood</td>
      <td>1938-05-23</td>
      <td>50.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Big Thunder Mountain Railroad</td>
      <td>Other</td>
      <td>NaN</td>
      <td>Arrow Development (California and Florida)Dyna...</td>
      <td>1980</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Steel</td>
      <td>NaT</td>
      <td>35.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>237</th>
      <td>Thunder Run (Canada's Wonderland)</td>
      <td>Canada's Wonderland</td>
      <td>Operating</td>
      <td>Mack Rides</td>
      <td>1986</td>
      <td>43.8427</td>
      <td>-79.5423</td>
      <td>Steel</td>
      <td>1981-05-23</td>
      <td>39.8</td>
      <td>32.8</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="183">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking an example duplicate</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df3.query(<span class="st">'Coaster_Name == "Crystal Beach Cyclone"'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="183">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Coaster_Name</th>
      <th>Location</th>
      <th>Status</th>
      <th>Manufacturer</th>
      <th>Year_Introduced</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Type_Main</th>
      <th>Opening_Date</th>
      <th>Speed_mph</th>
      <th>Height_ft</th>
      <th>Inversions</th>
      <th>Gforce</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>Crystal Beach Cyclone</td>
      <td>Crystal Beach Park</td>
      <td>Removed</td>
      <td>Traver Engineering</td>
      <td>1926</td>
      <td>42.8617</td>
      <td>-79.0598</td>
      <td>Wood</td>
      <td>1926-01-01</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Crystal Beach Cyclone</td>
      <td>Crystal Beach Park</td>
      <td>Removed</td>
      <td>Traver Engineering</td>
      <td>1927</td>
      <td>42.8617</td>
      <td>-79.0598</td>
      <td>Wood</td>
      <td>1926-01-01</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="184">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df3.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="184">
<pre><code>Index(['Coaster_Name', 'Location', 'Status', 'Manufacturer', 'Year_Introduced',
       'latitude', 'longitude', 'Type_Main', 'Opening_Date', 'Speed_mph',
       'Height_ft', 'Inversions', 'Gforce'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="185">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> df3.loc[<span class="op">~</span>df3.duplicated(subset<span class="op">=</span>[<span class="st">'Coaster_Name'</span>,<span class="st">'Location'</span>,<span class="st">'Opening_Date'</span>])] <span class="op">\</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    .reset_index(drop<span class="op">=</span><span class="va">True</span>).copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="186">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df4.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="186">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Coaster_Name</th>
      <th>Location</th>
      <th>Status</th>
      <th>Manufacturer</th>
      <th>Year_Introduced</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Type_Main</th>
      <th>Opening_Date</th>
      <th>Speed_mph</th>
      <th>Height_ft</th>
      <th>Inversions</th>
      <th>Gforce</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Switchback Railway</td>
      <td>Coney Island</td>
      <td>Removed</td>
      <td>LaMarcus Adna Thompson</td>
      <td>1884</td>
      <td>40.5740</td>
      <td>-73.9780</td>
      <td>Wood</td>
      <td>1884-06-16</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Flip Flap Railway</td>
      <td>Sea Lion Park</td>
      <td>Removed</td>
      <td>Lina Beecher</td>
      <td>1895</td>
      <td>40.5780</td>
      <td>-73.9790</td>
      <td>Wood</td>
      <td>1895-01-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Switchback Railway (Euclid Beach Park)</td>
      <td>Cleveland, Ohio, United States</td>
      <td>Closed</td>
      <td>NaN</td>
      <td>1896</td>
      <td>41.5800</td>
      <td>-81.5700</td>
      <td>Other</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Loop the Loop (Coney Island)</td>
      <td>Other</td>
      <td>Removed</td>
      <td>Edwin Prescott</td>
      <td>1901</td>
      <td>40.5745</td>
      <td>-73.9780</td>
      <td>Steel</td>
      <td>1901-01-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Loop the Loop (Young's Pier)</td>
      <td>Other</td>
      <td>Removed</td>
      <td>Edwin Prescott</td>
      <td>1901</td>
      <td>39.3538</td>
      <td>-74.4342</td>
      <td>Steel</td>
      <td>1901-01-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="187">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df4.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>Coaster_Name         0
Location             0
Status             146
Manufacturer        58
Year_Introduced      0
latitude           207
longitude          207
Type_Main            0
Opening_Date       183
Speed_mph          140
Height_ft          831
Inversions           0
Gforce             666
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="188">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df4.loc[df4.duplicated()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="188">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Coaster_Name</th>
      <th>Location</th>
      <th>Status</th>
      <th>Manufacturer</th>
      <th>Year_Introduced</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Type_Main</th>
      <th>Opening_Date</th>
      <th>Speed_mph</th>
      <th>Height_ft</th>
      <th>Inversions</th>
      <th>Gforce</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="189">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df5 <span class="op">=</span> df4.drop_duplicates(subset<span class="op">=</span>[<span class="st">"Coaster_Name"</span>], inplace<span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In this example, df is the DataFrame, subset is a parameter that takes a list of column names to consider when identifying duplicates, and inplace=True specifies that the changes should be made to the original DataFrame df rather than returning a new DataFrame.</p>
<p>Note that drop_duplicates by default keeps the first occurrence of each duplicate and drops the remaining duplicates. If you want to keep the last occurrence of each duplicate instead, you can use the keep=‘last’ argument.</p>
<div class="cell" data-execution_count="190">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>df5.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="190">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Coaster_Name</th>
      <th>Location</th>
      <th>Status</th>
      <th>Manufacturer</th>
      <th>Year_Introduced</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Type_Main</th>
      <th>Opening_Date</th>
      <th>Speed_mph</th>
      <th>Height_ft</th>
      <th>Inversions</th>
      <th>Gforce</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Switchback Railway</td>
      <td>Coney Island</td>
      <td>Removed</td>
      <td>LaMarcus Adna Thompson</td>
      <td>1884</td>
      <td>40.5740</td>
      <td>-73.9780</td>
      <td>Wood</td>
      <td>1884-06-16</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Flip Flap Railway</td>
      <td>Sea Lion Park</td>
      <td>Removed</td>
      <td>Lina Beecher</td>
      <td>1895</td>
      <td>40.5780</td>
      <td>-73.9790</td>
      <td>Wood</td>
      <td>1895-01-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Switchback Railway (Euclid Beach Park)</td>
      <td>Cleveland, Ohio, United States</td>
      <td>Closed</td>
      <td>NaN</td>
      <td>1896</td>
      <td>41.5800</td>
      <td>-81.5700</td>
      <td>Other</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Loop the Loop (Coney Island)</td>
      <td>Other</td>
      <td>Removed</td>
      <td>Edwin Prescott</td>
      <td>1901</td>
      <td>40.5745</td>
      <td>-73.9780</td>
      <td>Steel</td>
      <td>1901-01-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Loop the Loop (Young's Pier)</td>
      <td>Other</td>
      <td>Removed</td>
      <td>Edwin Prescott</td>
      <td>1901</td>
      <td>39.3538</td>
      <td>-74.4342</td>
      <td>Steel</td>
      <td>1901-01-01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="step-2-univariate-analysis" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="step-2-univariate-analysis"><span class="header-section-number">4</span> Step 2: Univariate Analysis</h2>
<p>This involves examining each variable in isolation to understand its distribution, central tendency, and spread. This can be done using techniques such as histograms, density plots, and box plots.</p>
<p><strong>Univariate distribution</strong></p>
<p>In univariate distribution, there is only one variable under consideration. It is the simplest form of analysis because only one quantity changes. It does not deal with causes or relationships.</p>
<p>The main purpose of the analysis is to describe the data and find patterns that exist within it. We can describe patterns found in univariate data using central tendency (mean, median and mode) and dispersion (range, variance, standard deviation, maximum and minimum values and interquartile range).</p>
<p>We can visualize the univariate data using various types of charts and graphs. These are frequency distribution tables, histograms, bar charts, pie charts and frequency polygons.</p>
<p>In Python, using the pandas library, univariate analysis can be performed using several built-in functions and methods.</p>
<pre><code>1. Descriptive statistics: Use the describe method to get a summary of the central tendency, dispersion, and shape of the distribution of the data. </code></pre>
<div class="cell" data-execution_count="191">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df5[<span class="st">'Year_Introduced'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="191">
<pre><code>count     990.000000
mean     1994.054545
std        23.872027
min      1884.000000
25%      1988.000000
50%      2000.000000
75%      2009.000000
max      2022.000000
Name: Year_Introduced, dtype: float64</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Frequency distribution: Use the value_counts method to get a frequency distribution of the unique values in a column.</li>
</ol>
<div class="cell" data-papermill="{&quot;duration&quot;:0.03705,&quot;end_time&quot;:&quot;2021-12-31T22:25:26.622753&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:26.585703&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="192">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df5[<span class="st">'Type_Main'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="192">
<pre><code>Steel    728
Wood     191
Other     71
Name: Type_Main, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.03309,&quot;end_time&quot;:&quot;2021-12-31T22:25:25.709352&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:25.676262&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="193">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df5[<span class="st">'Year_Introduced'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="193">
<pre><code>1999    46
2000    45
1998    30
2001    29
2002    28
        ..
1956     1
1959     1
1961     1
1895     1
1884     1
Name: Year_Introduced, Length: 101, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.283261,&quot;end_time&quot;:&quot;2021-12-31T22:25:26.016166&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:25.732905&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="194">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df5[<span class="st">'Year_Introduced'</span>].value_counts() <span class="op">\</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">10</span>) <span class="op">\</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    .plot(kind<span class="op">=</span><span class="st">'bar'</span>, title<span class="op">=</span><span class="st">'Top 10 Years Coasters Introduced'</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Year Introduced'</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Count'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="194">
<pre><code>Text(0, 0.5, 'Count')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-35-output-2.png" class="img-fluid"></p>
</div>
</div>
<pre><code>3. Histogram: Use the hist method to visualize the distribution of the data in a column. </code></pre>
<div class="cell" data-execution_count="195">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df5[<span class="st">'Year_Introduced'</span>].hist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="195">
<pre><code>&lt;AxesSubplot: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-36-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.294699,&quot;end_time&quot;:&quot;2021-12-31T22:25:26.334934&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:26.040235&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="196">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df5[<span class="st">'Speed_mph'</span>].plot(kind<span class="op">=</span><span class="st">'hist'</span>,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                          bins<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                          title<span class="op">=</span><span class="st">'Coaster Speed (mph)'</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Speed (mph)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="196">
<pre><code>Text(0.5, 0, 'Speed (mph)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-37-output-2.png" class="img-fluid"></p>
</div>
</div>
<pre><code>4. Density Plot: Use the density method to create a density plot, which is a smoothed version of a histogram</code></pre>
<div class="cell" data-execution_count="197">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df5[<span class="st">'Speed_mph'</span>].plot.density()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre><code>&lt;AxesSubplot: ylabel='Density'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-38-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.199427,&quot;end_time&quot;:&quot;2021-12-31T22:25:26.559519&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:26.360092&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="198">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df5[<span class="st">'Speed_mph'</span>].plot(kind<span class="op">=</span><span class="st">'kde'</span>,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                          title<span class="op">=</span><span class="st">'Coaster Speed (mph)'</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Speed (mph)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="198">
<pre><code>Text(0.5, 0, 'Speed (mph)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-39-output-2.png" class="img-fluid"></p>
</div>
</div>
<pre><code>5. Box Plot: Use the boxplot method to visualize the distribution of the data in a column and identify any outliers.</code></pre>
<div class="cell" data-execution_count="199">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df5.boxplot(column<span class="op">=</span><span class="st">'Speed_mph'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="199">
<pre><code>&lt;AxesSubplot: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-40-output-2.png" class="img-fluid"></p>
</div>
</div>
<pre><code>6. Violin Plot: Use the violinplot method to visualize the distribution of the data in a column and identify any outliers.</code></pre>
<div class="cell" data-execution_count="200">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>sns.violinplot(x<span class="op">=</span>df5[<span class="st">'Speed_mph'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="200">
<pre><code>&lt;AxesSubplot: xlabel='Speed_mph'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-41-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="step-3-bivariate-analysis" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="step-3-bivariate-analysis"><span class="header-section-number">5</span> Step 3: Bivariate Analysis</h2>
<p><strong>Bivariate distribution</strong></p>
<p>This type of data distribution involves two different variables. The analysis of this type of data deals with causes and relationships and the analysis is done to find out the relationship among the two variables. A very common example of bivariate distribution is height and weight of a single person.</p>
<p>Bivariate analysis means the analysis of bivariate data. It is one of the simplest forms of statistical analysis, used to find out if there is a relationship between two sets of values. Thus bivariate data analysis involves comparisons, exploring relationships, finding causes and explanations. These variables are often plotted on X and Y axis on the graph for better understanding of data and one of these variables is independent while the other is dependent.</p>
<p>Common types of bivariate analysis include drawing scatter plot, regression analysis and finding correlation coefficients. A scatter plot is used to find out if there exists any relationship between two variables. Regression analysis is a statistical method for estimating the relationships between variables. Correlation coefficient analysis measures the strength and direction of a linear relationship between two variables on a scatter plot.</p>
<ul>
<li><p>Scatterplot</p></li>
<li><p>Heatmap Correlation</p></li>
<li><p>Pairplot</p></li>
<li><p>Groupby comparisons</p>
<ol type="1">
<li>Visualize the relationship: Plot a scatter plot, a hexbin plot, a line plot, or a bar plot to visualize the relationship between the two variables.</li>
</ol></li>
</ul>
<div class="cell" data-papermill="{&quot;duration&quot;:0.183301,&quot;end_time&quot;:&quot;2021-12-31T22:25:26.884625&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:26.701324&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="201">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df5.plot(kind<span class="op">=</span><span class="st">'scatter'</span>,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Speed_mph'</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">'Height_ft'</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">'Coaster Speed vs. Height'</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-42-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.295762,&quot;end_time&quot;:&quot;2021-12-31T22:25:27.208343&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:26.912581&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="202">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span><span class="st">'Speed_mph'</span>,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                y<span class="op">=</span><span class="st">'Height_ft'</span>,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                hue<span class="op">=</span><span class="st">'Year_Introduced'</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                data<span class="op">=</span>df5)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Coaster Speed vs. Height'</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:6.429785,&quot;end_time&quot;:&quot;2021-12-31T22:25:33.666958&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:27.237173&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="203">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df5,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>             <span class="bu">vars</span><span class="op">=</span>[<span class="st">'Year_Introduced'</span>,<span class="st">'Speed_mph'</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'Height_ft'</span>,<span class="st">'Inversions'</span>,<span class="st">'Gforce'</span>],</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>            hue<span class="op">=</span><span class="st">'Type_Main'</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-44-output-1.png" class="img-fluid"></p>
</div>
</div>
<pre><code>2. Calculate the correlation: Use the corr method to calculate the Pearson correlation coefficient, which measures the linear relationship between two variables. A value of +1 indicates a strong positive relationship, a value of -1 indicates a strong negative relationship, and a value of 0 indicates no relationship.</code></pre>
<div class="cell" data-execution_count="204">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="op">=</span> df5[<span class="st">"Year_Introduced"</span>].corr(df5[<span class="st">"Gforce"</span>])</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Correlation:"</span>, correlation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation: -0.07340269375260203</code></pre>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.053233,&quot;end_time&quot;:&quot;2021-12-31T22:25:33.756533&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:33.703300&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="205">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df5_corr <span class="op">=</span> df5[[<span class="st">'Year_Introduced'</span>,<span class="st">'Speed_mph'</span>,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Height_ft'</span>,<span class="st">'Inversions'</span>,<span class="st">'Gforce'</span>]].dropna().corr()</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>df5_corr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="205">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year_Introduced</th>
      <th>Speed_mph</th>
      <th>Height_ft</th>
      <th>Inversions</th>
      <th>Gforce</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Year_Introduced</th>
      <td>1.000000</td>
      <td>0.171978</td>
      <td>0.135413</td>
      <td>-0.209887</td>
      <td>0.160247</td>
    </tr>
    <tr>
      <th>Speed_mph</th>
      <td>0.171978</td>
      <td>1.000000</td>
      <td>0.733999</td>
      <td>-0.028705</td>
      <td>0.607383</td>
    </tr>
    <tr>
      <th>Height_ft</th>
      <td>0.135413</td>
      <td>0.733999</td>
      <td>1.000000</td>
      <td>-0.079736</td>
      <td>0.466482</td>
    </tr>
    <tr>
      <th>Inversions</th>
      <td>-0.209887</td>
      <td>-0.028705</td>
      <td>-0.079736</td>
      <td>1.000000</td>
      <td>0.275991</td>
    </tr>
    <tr>
      <th>Gforce</th>
      <td>0.160247</td>
      <td>0.607383</td>
      <td>0.466482</td>
      <td>0.275991</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-papermill="{&quot;duration&quot;:0.305333,&quot;end_time&quot;:&quot;2021-12-31T22:25:34.098497&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:33.793164&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="206">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df5_corr, annot<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="206">
<pre><code>&lt;AxesSubplot: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-47-output-2.png" class="img-fluid"></p>
</div>
</div>
<pre><code>3. Check for outliers: Use box plots, violin plots, or scatter plots to identify any outliers in the data. Outliers can greatly affect the correlation coefficient and need to be treated accordingly.</code></pre>
<div class="cell" data-execution_count="207">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for outliers</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">"Height_ft"</span>, data<span class="op">=</span>df5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="207">
<pre><code>&lt;AxesSubplot: xlabel='Height_ft'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-48-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="208">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">"Year_Introduced"</span>, data<span class="op">=</span>df5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="208">
<pre><code>&lt;AxesSubplot: xlabel='Year_Introduced'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-49-output-2.png" class="img-fluid"></p>
</div>
</div>
<pre><code>4. Determine the type of relationship: Determine if the relationship is linear, non-linear, or non-existent. This can be done by visual inspection of the plots or by using statistical methods such as regression analysis.</code></pre>
<div class="cell" data-execution_count="209">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the type of relationship</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">"Height_ft"</span>, y<span class="op">=</span><span class="st">"Year_Introduced"</span>, data<span class="op">=</span>df5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="209">
<pre><code>&lt;AxesSubplot: xlabel='Height_ft', ylabel='Year_Introduced'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-50-output-2.png" class="img-fluid"></p>
</div>
</div>
<pre><code>5. Test for significance: Use hypothesis testing to determine if the correlation between the two variables is statistically significant. This can be done using a t-test or an ANOVA test.</code></pre>
<div class="cell" data-execution_count="210">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> pearsonr</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>correlation, p_value <span class="op">=</span> pearsonr(df5[<span class="st">"Inversions"</span>], df5[<span class="st">"Year_Introduced"</span>])</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Correlation:"</span>, correlation, <span class="st">"P-value:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation: 0.2337005348319422 P-value: 9.527794348890386e-14</code></pre>
</div>
</div>
<p>The six steps are a general guide for conducting bivariate analysis, and the specific methods used may vary depending on the type of data, the research question, and the tools available. However, by following these steps, you can gain a deeper understanding of the relationship between two variables and make informed conclusions about the data.</p>
<pre><code>6. Draw conclusions: Based on the results of the bivariate analysis, draw conclusions about the relationship between the two variables and any potential causality between them.</code></pre>
<div class="cell" data-execution_count="211">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw conclusions</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"There is a statistically significant relationship between Inversions and Years Introduced."</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"There is not a statistically significant relationship between Inversions and Years Introduced."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>There is a statistically significant relationship between Inversions and Years Introduced.</code></pre>
</div>
</div>
</section>
<section id="ask-a-question-about-the-data" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="ask-a-question-about-the-data"><span class="header-section-number">6</span> Ask a Question about the data</h2>
<ul>
<li>Try to answer a question you have about the data using a plot or statistic.</li>
</ul>
<p>What are the locations with the fastest roller coasters (minimum of 10)?</p>
<div class="cell" data-papermill="{&quot;duration&quot;:0.382299,&quot;end_time&quot;:&quot;2021-12-31T22:25:34.597495&quot;,&quot;exception&quot;:false,&quot;start_time&quot;:&quot;2021-12-31T22:25:34.215196&quot;,&quot;status&quot;:&quot;completed&quot;}" data-tags="[]" data-execution_count="212">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df5.query(<span class="st">'Location != "Other"'</span>) <span class="op">\</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">'Location'</span>)[<span class="st">'Speed_mph'</span>] <span class="op">\</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    .agg([<span class="st">'mean'</span>,<span class="st">'count'</span>]) <span class="op">\</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">'count &gt;= 10'</span>) <span class="op">\</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">'mean'</span>)[<span class="st">'mean'</span>] <span class="op">\</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    .plot(kind<span class="op">=</span><span class="st">'barh'</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>), title<span class="op">=</span><span class="st">'Average Coast Speed by Location'</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Average Coaster Speed'</span>)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-53-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="step-4-multivariate-analysis" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="step-4-multivariate-analysis"><span class="header-section-number">7</span> Step 4: Multivariate Analysis</h2>
<p><strong>Multivariate distribution</strong></p>
<p>When the dataset involves three or more variables, it is categorized under multivariate distribution. Multivariate analysis is used to study more complex sets of data. It is usually unsuitable for small sets of data.</p>
<p>Multivariate analysis helps to identify patterns, relationships, and interactions between multiple variables and provides a more comprehensive understanding of the data than univariate or bivariate analysis.</p>
<p>There are wide variety of analysis techniques to perform multivariate analysis. The choice of analysis techniques depends on the dataset and our goals to be achieved.</p>
<p>Some examples of multivariate analysis techniques are additive tree, cluster analysis, correspondence analysis, factor analysis, MANOVA (multivariate analysis of variance), multidimensional scaling, multiple regression analysis, principal component analysis and redundancy analysis.</p>
<p>There are several useful multivariate graphical EDA techniques, which are used to look at the distribution of multivariate data. These are as follows:-</p>
<pre><code>Side-by-Side Boxplots

Scatterplots

Curve Fitting

Heat Maps and 3-D Surface Plots</code></pre>
<p>Here are the steps for conducting multivariate analysis:</p>
<pre><code>1. Identify the research question: Clearly define the research question you want to answer with the multivariate analysis.

2. Prepare the data: Clean and transform the data as needed, and create a new dataset that includes all the variables of interest.

3. Visualize the relationships: Use scatter plots, pairwise plots, or heat maps to visualize the relationships between all the variables.

4. Perform dimension reduction: Use techniques such as principal component analysis (PCA) or singular value decomposition (SVD) to reduce the number of variables while retaining the maximum amount of information.

5. Clustering: Use clustering algorithms such as k-means or hierarchical clustering to group similar observations based on the variables.

6. Modeling: Use multivariate regression, logistic regression, or other statistical models to estimate the relationships between the variables and predict outcomes.

7. Evaluate the models: Evaluate the performance of the models using metrics such as mean squared error (MSE), root mean squared error (RMSE), or accuracy.

8. Draw conclusions: Based on the results of the analysis, draw conclusions about the relationships between the variables and any potential causality between them.</code></pre>
<p>These steps are a general guide for conducting multivariate analysis, and the specific methods used may vary depending on the type of data, the research question, and the tools available.</p>
<section id="review-step-0-3" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="review-step-0-3"><span class="header-section-number">7.1</span> Review Step 0-3</h3>
<div class="cell" data-execution_count="213">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>df6 <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/Dong2Yo/Dataset/main/winequality.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>df6.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="214">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>type</th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>white</td>
      <td>7.0</td>
      <td>0.27</td>
      <td>0.36</td>
      <td>20.7</td>
      <td>0.045</td>
      <td>45.0</td>
      <td>170.0</td>
      <td>1.0010</td>
      <td>3.00</td>
      <td>0.45</td>
      <td>8.8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>white</td>
      <td>6.3</td>
      <td>0.30</td>
      <td>0.34</td>
      <td>1.6</td>
      <td>0.049</td>
      <td>14.0</td>
      <td>132.0</td>
      <td>0.9940</td>
      <td>3.30</td>
      <td>0.49</td>
      <td>9.5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>white</td>
      <td>8.1</td>
      <td>0.28</td>
      <td>0.40</td>
      <td>6.9</td>
      <td>0.050</td>
      <td>30.0</td>
      <td>97.0</td>
      <td>0.9951</td>
      <td>3.26</td>
      <td>0.44</td>
      <td>10.1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>white</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>white</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="215">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df6.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="215">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>type</th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6492</th>
      <td>red</td>
      <td>6.2</td>
      <td>0.600</td>
      <td>0.08</td>
      <td>2.0</td>
      <td>0.090</td>
      <td>32.0</td>
      <td>44.0</td>
      <td>0.99490</td>
      <td>3.45</td>
      <td>0.58</td>
      <td>10.5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6493</th>
      <td>red</td>
      <td>5.9</td>
      <td>0.550</td>
      <td>0.10</td>
      <td>2.2</td>
      <td>0.062</td>
      <td>39.0</td>
      <td>51.0</td>
      <td>0.99512</td>
      <td>3.52</td>
      <td>NaN</td>
      <td>11.2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6494</th>
      <td>red</td>
      <td>6.3</td>
      <td>0.510</td>
      <td>0.13</td>
      <td>2.3</td>
      <td>0.076</td>
      <td>29.0</td>
      <td>40.0</td>
      <td>0.99574</td>
      <td>3.42</td>
      <td>0.75</td>
      <td>11.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6495</th>
      <td>red</td>
      <td>5.9</td>
      <td>0.645</td>
      <td>0.12</td>
      <td>2.0</td>
      <td>0.075</td>
      <td>32.0</td>
      <td>44.0</td>
      <td>0.99547</td>
      <td>3.57</td>
      <td>0.71</td>
      <td>10.2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6496</th>
      <td>red</td>
      <td>6.0</td>
      <td>0.310</td>
      <td>0.47</td>
      <td>3.6</td>
      <td>0.067</td>
      <td>18.0</td>
      <td>42.0</td>
      <td>0.99549</td>
      <td>3.39</td>
      <td>0.66</td>
      <td>11.0</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="216">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>df6.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="216">
<pre><code>(6497, 13)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="217">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>df6.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="217">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6487.000000</td>
      <td>6489.000000</td>
      <td>6494.000000</td>
      <td>6495.000000</td>
      <td>6495.000000</td>
      <td>6497.000000</td>
      <td>6497.000000</td>
      <td>6497.000000</td>
      <td>6488.000000</td>
      <td>6493.000000</td>
      <td>6497.000000</td>
      <td>6497.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7.216579</td>
      <td>0.339691</td>
      <td>0.318722</td>
      <td>5.444326</td>
      <td>0.056042</td>
      <td>30.525319</td>
      <td>115.744574</td>
      <td>0.994697</td>
      <td>3.218395</td>
      <td>0.531215</td>
      <td>10.491801</td>
      <td>5.818378</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.296750</td>
      <td>0.164649</td>
      <td>0.145265</td>
      <td>4.758125</td>
      <td>0.035036</td>
      <td>17.749400</td>
      <td>56.521855</td>
      <td>0.002999</td>
      <td>0.160748</td>
      <td>0.148814</td>
      <td>1.192712</td>
      <td>0.873255</td>
    </tr>
    <tr>
      <th>min</th>
      <td>3.800000</td>
      <td>0.080000</td>
      <td>0.000000</td>
      <td>0.600000</td>
      <td>0.009000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>0.987110</td>
      <td>2.720000</td>
      <td>0.220000</td>
      <td>8.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>6.400000</td>
      <td>0.230000</td>
      <td>0.250000</td>
      <td>1.800000</td>
      <td>0.038000</td>
      <td>17.000000</td>
      <td>77.000000</td>
      <td>0.992340</td>
      <td>3.110000</td>
      <td>0.430000</td>
      <td>9.500000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>7.000000</td>
      <td>0.290000</td>
      <td>0.310000</td>
      <td>3.000000</td>
      <td>0.047000</td>
      <td>29.000000</td>
      <td>118.000000</td>
      <td>0.994890</td>
      <td>3.210000</td>
      <td>0.510000</td>
      <td>10.300000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.700000</td>
      <td>0.400000</td>
      <td>0.390000</td>
      <td>8.100000</td>
      <td>0.065000</td>
      <td>41.000000</td>
      <td>156.000000</td>
      <td>0.996990</td>
      <td>3.320000</td>
      <td>0.600000</td>
      <td>11.300000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>15.900000</td>
      <td>1.580000</td>
      <td>1.660000</td>
      <td>65.800000</td>
      <td>0.611000</td>
      <td>289.000000</td>
      <td>440.000000</td>
      <td>1.038980</td>
      <td>4.010000</td>
      <td>2.000000</td>
      <td>14.900000</td>
      <td>9.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="218">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>df6.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 6497 entries, 0 to 6496
Data columns (total 13 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   type                  6497 non-null   object 
 1   fixed acidity         6487 non-null   float64
 2   volatile acidity      6489 non-null   float64
 3   citric acid           6494 non-null   float64
 4   residual sugar        6495 non-null   float64
 5   chlorides             6495 non-null   float64
 6   free sulfur dioxide   6497 non-null   float64
 7   total sulfur dioxide  6497 non-null   float64
 8   density               6497 non-null   float64
 9   pH                    6488 non-null   float64
 10  sulphates             6493 non-null   float64
 11  alcohol               6497 non-null   float64
 12  quality               6497 non-null   int64  
dtypes: float64(11), int64(1), object(1)
memory usage: 660.0+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="219">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>df6.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="219">
<pre><code>type                     object
fixed acidity           float64
volatile acidity        float64
citric acid             float64
residual sugar          float64
chlorides               float64
free sulfur dioxide     float64
total sulfur dioxide    float64
density                 float64
pH                      float64
sulphates               float64
alcohol                 float64
quality                   int64
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="220">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>df6.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="220">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>type</th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6492</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6493</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6494</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6495</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6496</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>6497 rows × 13 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="221">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>df6.duplicated().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="221">
<pre><code>1168</code></pre>
</div>
</div>
<div class="cell" data-execution_count="222">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>df6[<span class="st">'fixed acidity'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="222">
<pre><code>count    6487.000000
mean        7.216579
std         1.296750
min         3.800000
25%         6.400000
50%         7.000000
75%         7.700000
max        15.900000
Name: fixed acidity, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="223">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(df6[<span class="st">'fixed acidity'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="223">
<pre><code>&lt;AxesSubplot: xlabel='fixed acidity', ylabel='Count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-64-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="224">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Skewness: </span><span class="sc">{</span>df6[<span class="st">'fixed acidity'</span>]<span class="sc">.</span>skew()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Kurtosis: </span><span class="sc">{</span>df6[<span class="st">'fixed acidity'</span>]<span class="sc">.</span>kurt()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Skewness: 1.7228045308969795
Kurtosis: 5.057726963492721</code></pre>
</div>
</div>
<p>From this information we see how the distribution:</p>
<pre><code>does not follow a normal curve
show spikes
has kurtosis and asymmetry values greater than 1</code></pre>
<p>We do this for each variable, and we will have a pseudo-complete descriptive picture of their behavior.</p>
<p>We need this work to fully understand each variable, and unlocks the study of the relationship between variables.</p>
<p>Now the idea is to find interesting relationships that show the influence of one variable on the other, preferably on the target.</p>
<p>We can start exploring relationships with the help of Seaborn and pairplot.</p>
<div class="cell" data-execution_count="225">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the relationships</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="225">
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x1f4cb67ca90&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-66-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As you can see, pairplot displays all the variables against each other in a scatterplot. It is very useful for grasping the most important relationships without having to go through every single combination manually.</p>
<p>Be warned though — it is computationally expensive to compute, so it is best suited for datasets with relatively low number of variables like this one.</p>
<p>The best way to understand the relationship between a numeric variable and a categorical variable is through a boxplot.</p>
<p>Let’s create a boxplot for sulphates, citric acid, and chlorides. Why these variables? Because visually they show slightly more marked segmentations for a given wine type.</p>
<div class="cell" data-execution_count="226">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">"quality"</span>, y<span class="op">=</span><span class="st">"sulphates"</span>, data<span class="op">=</span>df6, kind<span class="op">=</span><span class="st">"box"</span>, aspect<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Boxplot for quality vs sulphates"</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-67-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="227">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">"quality"</span>, y<span class="op">=</span><span class="st">"citric acid"</span>, data<span class="op">=</span>df6, kind<span class="op">=</span><span class="st">"box"</span>, aspect<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Boxplot for quality vs citric acid"</span>)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-68-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="228">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">"quality"</span>, y<span class="op">=</span><span class="st">"chlorides"</span>, data<span class="op">=</span>df6, kind<span class="op">=</span><span class="st">"box"</span>, aspect<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Boxplot for quality vs chlorides"</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-69-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>With Seaborn we can create a scatterplot and visualize which wine class a point belongs to. Just specify the hue parameter.</p>
<div class="cell" data-execution_count="229">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">"chlorides"</span>, y<span class="op">=</span><span class="st">"citric acid"</span>, hue<span class="op">=</span><span class="st">"quality"</span>, data<span class="op">=</span>df6, palette<span class="op">=</span><span class="st">"Dark2"</span>, s<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Relationship between chlorides, citric acid and quality"</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-70-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>PCA stands for Principal Component Analysis, which is a widely used statistical method for dimensionality reduction.</p>
<p>PCA is a technique that is used to transform a set of correlated variables into a set of uncorrelated variables, called principal components, which explain the maximum amount of variability in the data. The first principal component explains the most variability in the data, the second principal component explains the second most variability, and so on. By reducing the number of variables, PCA makes it easier to visualize and analyze large and complex datasets, and can also improve the performance of machine learning models.</p>
<p><strong>PCA only works with numerical data.</strong></p>
<p>To change the string values “white” and “red” in a column to integer values, we can use the map method in Python.</p>
<div class="cell" data-execution_count="230">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>df6[<span class="st">'type'</span>] <span class="op">=</span> df6[<span class="st">'type'</span>].<span class="bu">map</span>({<span class="st">'white'</span>: <span class="dv">0</span>, <span class="st">'red'</span>: <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="231">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>df6.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="231">
<pre><code>type                      int64
fixed acidity           float64
volatile acidity        float64
citric acid             float64
residual sugar          float64
chlorides               float64
free sulfur dioxide     float64
total sulfur dioxide    float64
density                 float64
pH                      float64
sulphates               float64
alcohol                 float64
quality                   int64
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="232">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>df6[<span class="st">'type'</span>] <span class="op">=</span> df6[<span class="st">'type'</span>].astype(<span class="bu">float</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>df6[<span class="st">'quality'</span>] <span class="op">=</span> df6[<span class="st">'quality'</span>].astype(<span class="bu">float</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="233">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>df6.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="233">
<pre><code>type                    float64
fixed acidity           float64
volatile acidity        float64
citric acid             float64
residual sugar          float64
chlorides               float64
free sulfur dioxide     float64
total sulfur dioxide    float64
density                 float64
pH                      float64
sulphates               float64
alcohol                 float64
quality                 float64
dtype: object</code></pre>
</div>
</div>
<p><strong>PCA does not accept missing values encoded as NaN natively.</strong></p>
<div class="cell" data-execution_count="234">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>missing <span class="op">=</span> df6.isna().<span class="bu">sum</span>()</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>missing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="234">
<pre><code>type                     0
fixed acidity           10
volatile acidity         8
citric acid              3
residual sugar           2
chlorides                2
free sulfur dioxide      0
total sulfur dioxide     0
density                  0
pH                       9
sulphates                4
alcohol                  0
quality                  0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="235">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df6.isnull(), cbar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#heatmap is not a good visual representation.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-76-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="236">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the missing value</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>missing.plot.bar()</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-77-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Handling missing data is a common problem in data analysis, and there are several methods for addressing it. Here are a few common approaches:</p>
<pre><code>1. Drop missing values: This involves removing all rows or columns that contain missing values. This method is simple and straightforward, but can result in a loss of important information if too many values are missing.

'df.dropna(axis=0, inplace=True)'

2. Fill missing values: This involves replacing missing values with a value from the same column (such as the mean or median), or from another column.

'df.fillna(df.mean(), inplace=True)'

3. Interpolate missing values: This involves filling in missing values by estimating their values based on the values of other observations in the same column.

'df.interpolate(inplace=True)'

4. Impute missing values: This involves filling in missing values using statistical methods, such as linear regression or k-nearest neighbors.

'from sklearn.impute import KNNImputer'
'imputer = KNNImputer()'
'df_imputed = imputer.fit_transform(df)''</code></pre>
<p>The appropriate method for handling missing data depends on the type of data and the context of the problem. It’s important to carefully consider the trade-off between keeping missing data and imputing it, and to evaluate the effect of the chosen method on the results of any subsequent analysis.</p>
<div class="cell" data-execution_count="237">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer()</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>df6_imputed <span class="op">=</span> imputer.fit_transform(df6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="238">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>df6_imputed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="238">
<pre><code>array([[ 0.   ,  7.   ,  0.27 , ...,  0.45 ,  8.8  ,  6.   ],
       [ 0.   ,  6.3  ,  0.3  , ...,  0.49 ,  9.5  ,  6.   ],
       [ 0.   ,  8.1  ,  0.28 , ...,  0.44 , 10.1  ,  6.   ],
       ...,
       [ 1.   ,  6.3  ,  0.51 , ...,  0.75 , 11.   ,  6.   ],
       [ 1.   ,  5.9  ,  0.645, ...,  0.71 , 10.2  ,  5.   ],
       [ 1.   ,  6.   ,  0.31 , ...,  0.66 , 11.   ,  6.   ]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="239">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>df7 <span class="op">=</span> df6.interpolate(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="240">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>df6.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="240">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>type</th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>0.27</td>
      <td>0.36</td>
      <td>20.7</td>
      <td>0.045</td>
      <td>45.0</td>
      <td>170.0</td>
      <td>1.0010</td>
      <td>3.00</td>
      <td>0.45</td>
      <td>8.8</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>6.3</td>
      <td>0.30</td>
      <td>0.34</td>
      <td>1.6</td>
      <td>0.049</td>
      <td>14.0</td>
      <td>132.0</td>
      <td>0.9940</td>
      <td>3.30</td>
      <td>0.49</td>
      <td>9.5</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>8.1</td>
      <td>0.28</td>
      <td>0.40</td>
      <td>6.9</td>
      <td>0.050</td>
      <td>30.0</td>
      <td>97.0</td>
      <td>0.9951</td>
      <td>3.26</td>
      <td>0.44</td>
      <td>10.1</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="241">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>df6.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="241">
<pre><code>type                    0
fixed acidity           0
volatile acidity        0
citric acid             0
residual sugar          0
chlorides               0
free sulfur dioxide     0
total sulfur dioxide    0
density                 0
pH                      0
sulphates               0
alcohol                 0
quality                 0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="242">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform dimension reduction</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>principal_components <span class="op">=</span> pca.fit_transform(df6)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>principal_df6 <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> principal_components, columns <span class="op">=</span> [<span class="st">'PC1'</span>, <span class="st">'PC2'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="243">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span>principal_df6[<span class="st">'PC1'</span>], y<span class="op">=</span>df6[<span class="st">'quality'</span>])</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-84-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="244">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span>principal_df6[<span class="st">'PC2'</span>], y<span class="op">=</span>df6[<span class="st">'quality'</span>])</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-85-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="245">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modeling</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>reg <span class="op">=</span> LinearRegression().fit(principal_df6[[<span class="st">'PC1'</span>, <span class="st">'PC2'</span>]], df6[<span class="st">'quality'</span>])</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the models</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>R_squared <span class="op">=</span> reg.score(principal_df6[[<span class="st">'PC1'</span>, <span class="st">'PC2'</span>]], df6[<span class="st">'quality'</span>])</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R-squared:"</span>, R_squared)</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw conclusions</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The PCA and clustering methods were able to reduce the data to two principal components and group the observations into 3 clusters."</span>)</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The linear regression model using the two principal components as predictors was able to explain"</span>, R_squared, <span class="st">"of the variation in the target variable."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.017028762790542773
The PCA and clustering methods were able to reduce the data to two principal components and group the observations into 3 clusters.
The linear regression model using the two principal components as predictors was able to explain 0.017028762790542773 of the variation in the target variable.</code></pre>
</div>
</div>
</section>
</section>
<section id="step-5-data-visualization" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="step-5-data-visualization"><span class="header-section-number">8</span> Step 5: Data Visualization</h2>
<p>This is a crucial step in EDA, where the results of the analysis are visualized using various plots and charts. This helps in identifying patterns and relationships that may not be immediately apparent from the raw data.</p>
<div class="cell" data-execution_count="246">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>df6.quality.value_counts().plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Value counts of the target variable"</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Wine type"</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Count"</span>)</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-87-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="247">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution of wine quality</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">"quality"</span>, data<span class="op">=</span>df6)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-88-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="248">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">7</span>))</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(x<span class="op">=</span><span class="st">"alcohol"</span>,y<span class="op">=</span><span class="st">"fixed acidity"</span>,data <span class="op">=</span>df6,marker<span class="op">=</span> <span class="st">'o'</span>,c<span class="op">=</span><span class="st">"m"</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"alcohol"</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"fixed_acidity"</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-89-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="249">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x<span class="op">=</span><span class="st">"alcohol"</span>,y<span class="op">=</span><span class="st">"fixed acidity"</span>,data<span class="op">=</span>df6)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>plt.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="249">
<pre><code>[]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-90-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="250">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">7</span>))</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(x<span class="op">=</span><span class="st">"volatile acidity"</span>,y<span class="op">=</span><span class="st">"alcohol"</span>,data <span class="op">=</span>df6,marker<span class="op">=</span> <span class="st">'o'</span>,c<span class="op">=</span><span class="st">"m"</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"volatile_acidity"</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"alcohol"</span>,fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-91-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="251">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(df6[<span class="st">"quality"</span>],bins<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-92-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="252">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">7</span>))</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span><span class="st">"citric acid"</span>,y<span class="op">=</span><span class="st">"chlorides"</span>,data <span class="op">=</span>df6,marker<span class="op">=</span> <span class="st">'o'</span>,color<span class="op">=</span><span class="st">"m"</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-93-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="253">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> df6.corr()</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_matrix)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-94-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="254">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>df6,palette<span class="op">=</span><span class="st">"Set3"</span>)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-95-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>There are some outliers. We can remove the outliers.</p>
<div class="cell" data-execution_count="255">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>lower_limit <span class="op">=</span> df6[<span class="st">"free sulfur dioxide"</span>].mean() <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>df6[<span class="st">"free sulfur dioxide"</span>].std()</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>upper_limit <span class="op">=</span> df6[<span class="st">"free sulfur dioxide"</span>].mean() <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>df6[<span class="st">"free sulfur dioxide"</span>].std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="256">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lower_limit,upper_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-22.722879937833156 83.77351869418224</code></pre>
</div>
</div>
<div class="cell" data-execution_count="257">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>df7 <span class="op">=</span> df6[(df6[<span class="st">"free sulfur dioxide"</span>] <span class="op">&gt;</span> lower_limit) <span class="op">&amp;</span> (df6[<span class="st">"free sulfur dioxide"</span>] <span class="op">&lt;</span> upper_limit)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="258">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>df6.shape[<span class="dv">0</span>] <span class="op">-</span> df7.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="258">
<pre><code>36</code></pre>
</div>
</div>
<div class="cell" data-execution_count="259">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>lower_limit <span class="op">=</span> df7[<span class="st">'total sulfur dioxide'</span>].mean() <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>df7[<span class="st">'total sulfur dioxide'</span>].std()</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>upper_limit <span class="op">=</span> df7[<span class="st">'total sulfur dioxide'</span>].mean() <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>df7[<span class="st">'total sulfur dioxide'</span>].std()</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lower_limit,upper_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-53.15243132839596 283.65436601342924</code></pre>
</div>
</div>
<div class="cell" data-execution_count="260">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>df8 <span class="op">=</span> df7[(df7[<span class="st">'total sulfur dioxide'</span>] <span class="op">&gt;</span> lower_limit) <span class="op">&amp;</span> (df7[<span class="st">'total sulfur dioxide'</span>] <span class="op">&lt;</span> upper_limit)]</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>df8.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="260">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>type</th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>0.27</td>
      <td>0.36</td>
      <td>20.7</td>
      <td>0.045</td>
      <td>45.0</td>
      <td>170.0</td>
      <td>1.0010</td>
      <td>3.00</td>
      <td>0.45</td>
      <td>8.8</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>6.3</td>
      <td>0.30</td>
      <td>0.34</td>
      <td>1.6</td>
      <td>0.049</td>
      <td>14.0</td>
      <td>132.0</td>
      <td>0.9940</td>
      <td>3.30</td>
      <td>0.49</td>
      <td>9.5</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>8.1</td>
      <td>0.28</td>
      <td>0.40</td>
      <td>6.9</td>
      <td>0.050</td>
      <td>30.0</td>
      <td>97.0</td>
      <td>0.9951</td>
      <td>3.26</td>
      <td>0.44</td>
      <td>10.1</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="261">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>df7.shape[<span class="dv">0</span>] <span class="op">-</span> df8.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="261">
<pre><code>5</code></pre>
</div>
</div>
<div class="cell" data-execution_count="262">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>lower_limit <span class="op">=</span> df8[<span class="st">'residual sugar'</span>].mean() <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>df8[<span class="st">'residual sugar'</span>].std()</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>upper_limit <span class="op">=</span> df8[<span class="st">'residual sugar'</span>].mean() <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>df8[<span class="st">'residual sugar'</span>].std()</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lower_limit,upper_limit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-8.837326393286151 19.713565550659137</code></pre>
</div>
</div>
<div class="cell" data-execution_count="263">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>df9 <span class="op">=</span> df8[(df8[<span class="st">'residual sugar'</span>] <span class="op">&gt;</span> lower_limit) <span class="op">&amp;</span> (df8[<span class="st">'residual sugar'</span>] <span class="op">&lt;</span> upper_limit)]</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>df9.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="263">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>type</th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>6.3</td>
      <td>0.30</td>
      <td>0.34</td>
      <td>1.6</td>
      <td>0.049</td>
      <td>14.0</td>
      <td>132.0</td>
      <td>0.9940</td>
      <td>3.30</td>
      <td>0.49</td>
      <td>9.5</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>8.1</td>
      <td>0.28</td>
      <td>0.40</td>
      <td>6.9</td>
      <td>0.050</td>
      <td>30.0</td>
      <td>97.0</td>
      <td>0.9951</td>
      <td>3.26</td>
      <td>0.44</td>
      <td>10.1</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>8.1</td>
      <td>0.28</td>
      <td>0.40</td>
      <td>6.9</td>
      <td>0.050</td>
      <td>30.0</td>
      <td>97.0</td>
      <td>0.9951</td>
      <td>3.26</td>
      <td>0.44</td>
      <td>10.1</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="264">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>df8.shape[<span class="dv">0</span>] <span class="op">-</span> df9.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="264">
<pre><code>26</code></pre>
</div>
</div>
<div class="cell" data-execution_count="265">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>df9.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="265">
<pre><code>type                    0
fixed acidity           0
volatile acidity        0
citric acid             0
residual sugar          0
chlorides               0
free sulfur dioxide     0
total sulfur dioxide    0
density                 0
pH                      0
sulphates               0
alcohol                 0
quality                 0
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="step-6-modeling" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="step-6-modeling"><span class="header-section-number">9</span> Step 6: Modeling</h2>
<p>In the final stage of EDA, simple models such as linear regression or decision trees may be used to test the relationships identified in the previous steps.</p>
<section id="feature-selection" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="feature-selection"><span class="header-section-number">9.1</span> Feature Selection</h3>
<div class="cell" data-execution_count="266">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>df9.quality.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="266">
<pre><code>6.0    2806
5.0    2116
7.0    1075
4.0     214
8.0     189
3.0      25
9.0       5
Name: quality, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="267">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>df9.quality.value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="267">
<pre><code>6.0    0.436392
5.0    0.329082
7.0    0.167185
4.0    0.033281
8.0    0.029393
3.0    0.003888
9.0    0.000778
Name: quality, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="268">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>df9.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="268">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>type</th>
      <th>fixed acidity</th>
      <th>volatile acidity</th>
      <th>citric acid</th>
      <th>residual sugar</th>
      <th>chlorides</th>
      <th>free sulfur dioxide</th>
      <th>total sulfur dioxide</th>
      <th>density</th>
      <th>pH</th>
      <th>sulphates</th>
      <th>alcohol</th>
      <th>quality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>6.3</td>
      <td>0.30</td>
      <td>0.34</td>
      <td>1.6</td>
      <td>0.049</td>
      <td>14.0</td>
      <td>132.0</td>
      <td>0.9940</td>
      <td>3.30</td>
      <td>0.49</td>
      <td>9.5</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>8.1</td>
      <td>0.28</td>
      <td>0.40</td>
      <td>6.9</td>
      <td>0.050</td>
      <td>30.0</td>
      <td>97.0</td>
      <td>0.9951</td>
      <td>3.26</td>
      <td>0.44</td>
      <td>10.1</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>7.2</td>
      <td>0.23</td>
      <td>0.32</td>
      <td>8.5</td>
      <td>0.058</td>
      <td>47.0</td>
      <td>186.0</td>
      <td>0.9956</td>
      <td>3.19</td>
      <td>0.40</td>
      <td>9.9</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>8.1</td>
      <td>0.28</td>
      <td>0.40</td>
      <td>6.9</td>
      <td>0.050</td>
      <td>30.0</td>
      <td>97.0</td>
      <td>0.9951</td>
      <td>3.26</td>
      <td>0.44</td>
      <td>10.1</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="269">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>quaity_mapping <span class="op">=</span> { <span class="fl">3.0</span> : <span class="st">"Low"</span>, <span class="fl">4.0</span> : <span class="st">"Low"</span>, <span class="fl">5.0</span>: <span class="st">"Medium"</span>, <span class="fl">6.0</span> : <span class="st">"Medium"</span>, <span class="fl">7.0</span> : <span class="st">"Medium"</span>, <span class="fl">8.0</span> : <span class="st">"High"</span>, <span class="fl">9.0</span> : <span class="st">"High"</span>}</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>df9.loc[:, <span class="st">"quality"</span>] <span class="op">=</span> df9[<span class="st">"quality"</span>].<span class="bu">map</span>(quaity_mapping)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="270">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>df9.quality.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="270">
<pre><code>Medium    5997
Low        239
High       194
Name: quality, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="271">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">"quality"</span>] <span class="op">=</span> df9[<span class="st">"quality"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">"quality"</span>] <span class="op">=</span> df9[<span class="st">"quality"</span>].cat.codes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="272">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>df9.quality.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="272">
<pre><code>2    5997
1     239
0     194
Name: quality, dtype: int64</code></pre>
</div>
</div>
<p>Let us select the best features for the model.</p>
<p>ExtraTreesClassifier is an ensemble method for classification that uses multiple decision trees to make predictions. It’s a type of random forest algorithm, where each tree in the forest is built using a different random subset of the data and random subset of features. The final prediction is made by taking the average prediction from all the trees.</p>
<p>Once you’ve created the model instance, you can fit it to your training data and use it to make predictions on new data. To do this, you’ll need to call the fit method on the model and pass in your training data.</p>
<div class="cell" data-execution_count="273">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df9.drop(<span class="st">"quality"</span>,axis<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df9[<span class="st">"quality"</span>]</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> ExtraTreesClassifier()</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>model.fit(x,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="273">
<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ExtraTreesClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked=""><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">ExtraTreesClassifier</label><div class="sk-toggleable__content"><pre>ExtraTreesClassifier()</pre></div></div></div></div></div>
</div>
</div>
<p>In machine learning, feature importance refers to the measure of how much a particular feature contributes to the prediction made by the model. In the case of decision tree based models, feature importances are typically calculated based on the reduction in impurity (such as Gini impurity or entropy) achieved when splitting a node in the tree based on that feature.</p>
<p>In the ExtraTreesClassifier model, the feature importances are stored in the feature_importances_ attribute. This attribute is an array where each element corresponds to the feature importance of a feature in the training data. The larger the value of the element, the more important the feature is considered by the model.</p>
<div class="cell" data-execution_count="274">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.feature_importances_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[0.00803736 0.08489505 0.11022261 0.08514657 0.08821102 0.08393457
 0.10026815 0.08660405 0.08501652 0.08455986 0.09004359 0.09306065]</code></pre>
</div>
</div>
<p>We are printing the array of feature importances calculated by the ExtraTreesClassifier model.</p>
<p>This information can be used to determine which features are the most important in predicting the target variable, and can be useful in feature selection and feature engineering.</p>
<div class="cell" data-execution_count="275">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>feat_importances <span class="op">=</span> pd.Series(model.feature_importances_,index <span class="op">=</span>x.columns)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>feat_importances.nlargest(<span class="dv">9</span>).plot(kind<span class="op">=</span><span class="st">"barh"</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-116-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We are creating a pandas Series named feat_importances from the feature importances of the model (ExtraTreesClassifier). The index of the Series is set to the columns of the input feature data x, so each feature importance is associated with its corresponding feature.</p>
<p>Next, the code uses the nlargest method of the Series to select the 9 largest feature importances. Finally, the code plots these 9 largest feature importances as a horizontal bar plot using the plot method and specifying kind=“barh”. Finally, the code calls plt.show() to display the plot.</p>
<p>This code is used to visualize the feature importances of the ExtraTreesClassifier model in a bar plot. The bar plot provides a visual representation of the most important features in the data, and can be useful for interpreting the results of the model, as well as for feature selection.</p>
</section>
<section id="model-selection" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="model-selection"><span class="header-section-number">9.2</span> Model Selection</h3>
<div class="cell" data-execution_count="276">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="277">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>model_params  <span class="op">=</span> {</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"svm"</span> : {</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>:SVC(gamma<span class="op">=</span><span class="st">"auto"</span>),</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>:{</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">'C'</span> : [<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">20</span>],</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'kernel'</span>:[<span class="st">"rbf"</span>]</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"decision_tree"</span>:{</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: DecisionTreeClassifier(),</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>:{</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">'criterion'</span>:[<span class="st">"entropy"</span>,<span class="st">"gini"</span>],</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>:[<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">9</span>]</span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"random_forest"</span>:{</span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: RandomForestClassifier(),</span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>:{</span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>:[<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>],</span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>:[<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">9</span>]</span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"naive_bayes"</span>:{</span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: GaussianNB(),</span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>:{}</span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb188-29"><a href="#cb188-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-30"><a href="#cb188-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'logistic_regression'</span> : {</span>
<span id="cb188-31"><a href="#cb188-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'model'</span> : LogisticRegression(solver<span class="op">=</span><span class="st">'liblinear'</span>,multi_class <span class="op">=</span> <span class="st">'auto'</span>),</span>
<span id="cb188-32"><a href="#cb188-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'params'</span>: {</span>
<span id="cb188-33"><a href="#cb188-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">"C"</span> : [<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>]</span>
<span id="cb188-34"><a href="#cb188-34" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb188-35"><a href="#cb188-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb188-36"><a href="#cb188-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb188-37"><a href="#cb188-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="278">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>score<span class="op">=</span>[]</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model_name,mp <span class="kw">in</span> model_params.items():</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>    clf <span class="op">=</span> GridSearchCV(mp[<span class="st">"model"</span>],mp[<span class="st">"params"</span>],cv<span class="op">=</span><span class="dv">8</span>,return_train_score<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>    clf.fit(x,y)</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>    score.append({</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Model"</span> : model_name,</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Best_Score"</span>: clf.best_score_,</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Best_Params"</span>: clf.best_params_</span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="279">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>df10 <span class="op">=</span> pd.DataFrame(score,columns<span class="op">=</span>[<span class="st">"Model"</span>,<span class="st">"Best_Score"</span>,<span class="st">"Best_Params"</span>])</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>df10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="279">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Model</th>
      <th>Best_Score</th>
      <th>Best_Params</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>svm</td>
      <td>0.932193</td>
      <td>{'C': 1, 'kernel': 'rbf'}</td>
    </tr>
    <tr>
      <th>1</th>
      <td>decision_tree</td>
      <td>0.920520</td>
      <td>{'criterion': 'gini', 'max_depth': 5}</td>
    </tr>
    <tr>
      <th>2</th>
      <td>random_forest</td>
      <td>0.930948</td>
      <td>{'max_depth': 5, 'n_estimators': 10}</td>
    </tr>
    <tr>
      <th>3</th>
      <td>naive_bayes</td>
      <td>0.726065</td>
      <td>{}</td>
    </tr>
    <tr>
      <th>4</th>
      <td>logistic_regression</td>
      <td>0.932971</td>
      <td>{'C': 10}</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We are getting 93% accuracy for SVM &amp; Random Forest.</p>
<div class="cell" data-execution_count="280">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>clf_svm <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">"rbf"</span>,C<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> cross_val_score(clf_svm,x,y,cv<span class="op">=</span><span class="dv">8</span>,scoring<span class="op">=</span><span class="st">"accuracy"</span>)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="280">
<pre><code>array([0.93283582, 0.93283582, 0.93283582, 0.93283582, 0.93283582,
       0.93159204, 0.93275218, 0.93275218])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="281">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>scores.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="281">
<pre><code>0.9326594378667064</code></pre>
</div>
</div>
</section>
<section id="prediction-model" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="prediction-model"><span class="header-section-number">9.3</span> Prediction Model</h3>
<p>The train_test_split function is a utility function provided by scikit-learn, a popular machine learning library in Python.</p>
<p>The function splits the data into training and testing sets, with the argument test_size specifying the proportion of the data that should be used for testing (in this case, 20%). The random_state argument is used to specify the random seed for the random number generator, ensuring that the split is reproducible.</p>
<p>The function returns four variables: x_train and y_train, which are the training data for the input features and target variable, respectively; and x_test and y_test, which are the testing data for the input features and target variable, respectively.</p>
<p>This split is a common and crucial step in the machine learning process, as it allows the model to be trained on a subset of the data and evaluated on a separate, held-out subset of the data. This helps to prevent overfitting, which is when the model becomes too closely tied to the training data, and to get a more accurate estimate of the model’s performance on unseen data.</p>
<div class="cell" data-execution_count="282">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>x_train,x_test,y_train,y_test <span class="op">=</span> train_test_split(x,y,test_size<span class="op">=</span><span class="fl">0.2</span>,random_state<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="283">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>clf_svm1 <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">"rbf"</span>,C<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>clf_svm1.fit(x_train,y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="283">
<style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVC(C=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked=""><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC(C=1)</pre></div></div></div></div></div>
</div>
</div>
<p>The code is fitting a Support Vector Machine (SVM) classifier with a radial basis function (RBF) kernel and a regularization parameter C = 1. The SVM classifier is trained on the training data set x_train and y_train and the learned model is stored in the variable clf_svm1.</p>
<div class="cell" data-execution_count="284">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> clf_svm1.predict(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="285">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test,y_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="286">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="286">
<pre><code>0.9339035769828927</code></pre>
</div>
</div>
<p>Compare the Real value and Predicted Value</p>
<div class="cell" data-execution_count="287">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>accuracy_dataframe <span class="op">=</span> pd.DataFrame({<span class="st">"y_test"</span>: y_test, <span class="st">"y_pred"</span>: y_pred})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="288">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>accuracy_dataframe.head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="288">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>y_test</th>
      <th>y_pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1935</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1106</th>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2932</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>743</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2230</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1584</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4583</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>567</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4333</th>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4414</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4966</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2992</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2730</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5699</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3860</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4397</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3539</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2261</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1873</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2671</th>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="289">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> clf_svm1.predict(x_test)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy:"</span>, accuracy)</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>mismatch <span class="op">=</span> (y_test <span class="op">!=</span> y_pred)</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mismatched samples:"</span>, mismatch.<span class="bu">sum</span>())</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>x_test_mismatch <span class="op">=</span> x_test[mismatch]</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>y_test_mismatch <span class="op">=</span> y_test[mismatch]</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>y_pred_mismatch <span class="op">=</span> y_pred[mismatch]</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mismatched Actual vs Predicted:"</span>)</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (act, pred) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(y_test_mismatch, y_pred_mismatch)):</span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Sample </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: Actual=</span><span class="sc">{</span>act<span class="sc">}</span><span class="ss">, Predicted=</span><span class="sc">{</span>pred<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.9339035769828927
Mismatched samples: 85
Mismatched Actual vs Predicted:
Sample 0: Actual=0, Predicted=2
Sample 1: Actual=0, Predicted=2
Sample 2: Actual=0, Predicted=2
Sample 3: Actual=1, Predicted=2
Sample 4: Actual=1, Predicted=2
Sample 5: Actual=0, Predicted=2
Sample 6: Actual=1, Predicted=2
Sample 7: Actual=0, Predicted=2
Sample 8: Actual=1, Predicted=2
Sample 9: Actual=0, Predicted=2
Sample 10: Actual=0, Predicted=2
Sample 11: Actual=1, Predicted=2
Sample 12: Actual=0, Predicted=2
Sample 13: Actual=1, Predicted=2
Sample 14: Actual=0, Predicted=2
Sample 15: Actual=0, Predicted=2
Sample 16: Actual=0, Predicted=2
Sample 17: Actual=0, Predicted=2
Sample 18: Actual=0, Predicted=2
Sample 19: Actual=0, Predicted=2
Sample 20: Actual=1, Predicted=2
Sample 21: Actual=0, Predicted=2
Sample 22: Actual=1, Predicted=2
Sample 23: Actual=1, Predicted=2
Sample 24: Actual=0, Predicted=2
Sample 25: Actual=1, Predicted=2
Sample 26: Actual=1, Predicted=2
Sample 27: Actual=0, Predicted=2
Sample 28: Actual=0, Predicted=2
Sample 29: Actual=1, Predicted=2
Sample 30: Actual=1, Predicted=2
Sample 31: Actual=1, Predicted=2
Sample 32: Actual=1, Predicted=2
Sample 33: Actual=1, Predicted=2
Sample 34: Actual=1, Predicted=2
Sample 35: Actual=1, Predicted=2
Sample 36: Actual=1, Predicted=2
Sample 37: Actual=1, Predicted=2
Sample 38: Actual=1, Predicted=2
Sample 39: Actual=1, Predicted=2
Sample 40: Actual=1, Predicted=2
Sample 41: Actual=1, Predicted=2
Sample 42: Actual=0, Predicted=2
Sample 43: Actual=1, Predicted=2
Sample 44: Actual=0, Predicted=2
Sample 45: Actual=1, Predicted=2
Sample 46: Actual=1, Predicted=2
Sample 47: Actual=0, Predicted=2
Sample 48: Actual=0, Predicted=2
Sample 49: Actual=0, Predicted=2
Sample 50: Actual=0, Predicted=2
Sample 51: Actual=1, Predicted=2
Sample 52: Actual=0, Predicted=2
Sample 53: Actual=0, Predicted=2
Sample 54: Actual=0, Predicted=2
Sample 55: Actual=1, Predicted=2
Sample 56: Actual=1, Predicted=2
Sample 57: Actual=0, Predicted=2
Sample 58: Actual=1, Predicted=2
Sample 59: Actual=0, Predicted=2
Sample 60: Actual=1, Predicted=2
Sample 61: Actual=1, Predicted=2
Sample 62: Actual=0, Predicted=2
Sample 63: Actual=1, Predicted=2
Sample 64: Actual=1, Predicted=2
Sample 65: Actual=1, Predicted=2
Sample 66: Actual=1, Predicted=2
Sample 67: Actual=0, Predicted=2
Sample 68: Actual=1, Predicted=2
Sample 69: Actual=0, Predicted=2
Sample 70: Actual=0, Predicted=2
Sample 71: Actual=0, Predicted=2
Sample 72: Actual=1, Predicted=2
Sample 73: Actual=1, Predicted=2
Sample 74: Actual=0, Predicted=2
Sample 75: Actual=0, Predicted=2
Sample 76: Actual=1, Predicted=2
Sample 77: Actual=0, Predicted=2
Sample 78: Actual=1, Predicted=2
Sample 79: Actual=0, Predicted=2
Sample 80: Actual=1, Predicted=2
Sample 81: Actual=1, Predicted=2
Sample 82: Actual=0, Predicted=2
Sample 83: Actual=1, Predicted=2
Sample 84: Actual=1, Predicted=2</code></pre>
</div>
</div>
</section>
</section>
<section id="titanic-case" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="titanic-case"><span class="header-section-number">10</span> Titanic Case</h2>
<div class="cell" data-execution_count="290">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the Titanic dataset</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>titanic <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/Dong2Yo/Dataset/main/titanic.csv"</span>)</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get information about the dataset</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(titanic.info())</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the summary statistics of the dataset</span></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(titanic.describe())</span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution of ages</span></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a>sns.histplot(titanic[<span class="st">"Age"</span>].dropna())</span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distribution of fares</span></span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true" tabindex="-1"></a>sns.histplot(titanic[<span class="st">"Fare"</span>])</span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the relationship between age and fare</span></span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true" tabindex="-1"></a>sns.jointplot(x<span class="op">=</span><span class="st">"Age"</span>, y<span class="op">=</span><span class="st">"Fare"</span>, data<span class="op">=</span>titanic, kind<span class="op">=</span><span class="st">"reg"</span>)</span>
<span id="cb205-24"><a href="#cb205-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb205-25"><a href="#cb205-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-26"><a href="#cb205-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the relationship between class and survival</span></span>
<span id="cb205-27"><a href="#cb205-27" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">"Pclass"</span>, hue<span class="op">=</span><span class="st">"Survived"</span>, data<span class="op">=</span>titanic)</span>
<span id="cb205-28"><a href="#cb205-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb205-29"><a href="#cb205-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-30"><a href="#cb205-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the relationship between gender and survival</span></span>
<span id="cb205-31"><a href="#cb205-31" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">"Sex"</span>, hue<span class="op">=</span><span class="st">"Survived"</span>, data<span class="op">=</span>titanic)</span>
<span id="cb205-32"><a href="#cb205-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 887 entries, 0 to 886
Data columns (total 8 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   Survived                 887 non-null    int64  
 1   Pclass                   887 non-null    int64  
 2   Name                     887 non-null    object 
 3   Sex                      887 non-null    object 
 4   Age                      887 non-null    float64
 5   Siblings/Spouses Aboard  887 non-null    int64  
 6   Parents/Children Aboard  887 non-null    int64  
 7   Fare                     887 non-null    float64
dtypes: float64(2), int64(4), object(2)
memory usage: 55.6+ KB
None
         Survived      Pclass         Age  Siblings/Spouses Aboard  \
count  887.000000  887.000000  887.000000               887.000000   
mean     0.385569    2.305524   29.471443                 0.525366   
std      0.487004    0.836662   14.121908                 1.104669   
min      0.000000    1.000000    0.420000                 0.000000   
25%      0.000000    2.000000   20.250000                 0.000000   
50%      0.000000    3.000000   28.000000                 0.000000   
75%      1.000000    3.000000   38.000000                 1.000000   
max      1.000000    3.000000   80.000000                 8.000000   

       Parents/Children Aboard       Fare  
count               887.000000  887.00000  
mean                  0.383315   32.30542  
std                   0.807466   49.78204  
min                   0.000000    0.00000  
25%                   0.000000    7.92500  
50%                   0.000000   14.45420  
75%                   0.000000   31.13750  
max                   6.000000  512.32920  </code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-132-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-132-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-132-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-132-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-132-output-6.png" class="img-fluid"></p>
</div>
</div>
<p>We can see that there is a strong relationship between class and survival, with passengers in higher class more likely to survive. We can also see that there is a relationship between gender and survival, with female passengers more likely to survive.</p>
<p>From these initial observations, we can further explore the data to answer additional questions, such as:</p>
<pre><code>How does the relationship between class and survival vary by gender?
How does age affect survival for different classes and genders?
What other factors might be related to survival on the Titanic?</code></pre>
<p><strong>Grouping by multiple variables</strong>: To understand the relationship between class, gender, and survival, we can group the data by these variables and calculate the survival rate for each group.</p>
<div class="cell" data-execution_count="291">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group the data by class and gender and calculate the mean survival rate</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> titanic.groupby([<span class="st">"Pclass"</span>, <span class="st">"Sex"</span>])[<span class="st">"Survived"</span>].mean()</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Pclass  Sex   
1       female    0.968085
        male      0.368852
2       female    0.921053
        male      0.157407
3       female    0.500000
        male      0.137026
Name: Survived, dtype: float64</code></pre>
</div>
</div>
<p><strong>Cross-tabulation</strong>: To compare the survival rate between different groups, we can create a cross-tabulation (also known as a pivot table) that shows the number of survivors for each class and gender.</p>
<div class="cell" data-execution_count="292">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a cross-tabulation of class and gender by survival</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>ct <span class="op">=</span> pd.crosstab(titanic[<span class="st">"Pclass"</span>], titanic[<span class="st">"Sex"</span>], values<span class="op">=</span>titanic[<span class="st">"Survived"</span>], aggfunc<span class="op">=</span><span class="st">"mean"</span>)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sex       female      male
Pclass                    
1       0.968085  0.368852
2       0.921053  0.157407
3       0.500000  0.137026</code></pre>
</div>
</div>
<p><strong>Handling missing values</strong>: In many datasets, missing values are a common problem. To handle missing values in the Titanic dataset, we can fill in the missing values with the mean or median value of the column.</p>
<div class="cell" data-execution_count="293">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill in the missing values in the Age column with the mean value</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"Age"</span>].fillna(titanic[<span class="st">"Age"</span>].mean(), inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Plotting multiple variables</strong>: To better understand the relationships between multiple variables, we can create a scatter plot matrix that plots all the variables against each other.</p>
<div class="cell" data-execution_count="294">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot matrix of all the variables</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>sns.pairplot(titanic, hue<span class="op">=</span><span class="st">"Survived"</span>)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-136-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Building models with the Titanic dataset can help us answer more advanced questions about survival on the ship. There are several machine learning algorithms that can be used for this task.</p>
<pre><code>Logistic Regression: Logistic regression is a simple and fast algorithm that can be used to predict binary outcomes, such as survival or death. In this case, we would use logistic regression to predict the survival of passengers on the Titanic based on their characteristics, such as age, gender, and class.</code></pre>
<div class="cell" data-execution_count="295">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the name variable</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>titanic.drop(columns<span class="op">=</span>[<span class="st">"Name"</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The axis parameter is set to 1 to indicate that you want to drop a column (as opposed to a row). By default, the drop method does not modify the original dataframe, but returns a new dataframe with the specified column dropped. To modify the original dataframe, you can use the inplace parameter and set it to True:</p>
<div class="cell" data-execution_count="296">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"Sex"</span>] <span class="op">=</span> titanic[<span class="st">"Sex"</span>].<span class="bu">map</span>({<span class="st">"male"</span>: <span class="dv">0</span>, <span class="st">"female"</span>: <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This code maps the values “male” to 0 and “female” to 1, creating a new integer representation of the “Sex” column. You can then use this integer representation in your analysis and modeling, instead of the original string values. Note that the map method does not modify the original dataframe, but returns a new dataframe with the specified mapping applied. To modify the original dataframe, you can assign the result of the map method back to the original column:</p>
<div class="cell" data-execution_count="297">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the necessary libraries</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for modeling</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> titanic.drop([<span class="st">"Survived"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> titanic[<span class="st">"Survived"</span>]</span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> titanic[[<span class="st">"Pclass"</span>, <span class="st">"Sex"</span>, <span class="st">"Age"</span>]]</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> titanic[<span class="st">"Survived"</span>]</span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Train a logistic regression model</span></span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> LogisticRegression()</span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>model1.fit(X_train, y_train)</span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model on the testing set</span></span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a>score <span class="op">=</span> model1.score(X_test, y_test)</span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Logistic Regression Accuracy: </span><span class="sc">{:.2f}</span><span class="st">%"</span>.<span class="bu">format</span>(score <span class="op">*</span> <span class="dv">100</span>))</span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-22"><a href="#cb217-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the logistic regression model</span></span>
<span id="cb217-23"><a href="#cb217-23" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span>X_train[<span class="st">"Age"</span>], y<span class="op">=</span>y_train, logistic<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb217-24"><a href="#cb217-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb217-25"><a href="#cb217-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-26"><a href="#cb217-26" aria-hidden="true" tabindex="-1"></a>sns.regplot(x<span class="op">=</span>X_train[<span class="st">"Pclass"</span>], y<span class="op">=</span>y_train, logistic<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb217-27"><a href="#cb217-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Accuracy: 76.97%</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-139-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-139-output-3.png" class="img-fluid"></p>
</div>
</div>
<pre><code>Decision Trees: Decision trees are a type of tree-based algorithm that can be used to model decision-making processes. In this case, we would use a decision tree to model the decision-making process that passengers on the Titanic went through to determine their survival.</code></pre>
<div class="cell" data-execution_count="298">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the necessary libraries</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train a decision tree model</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>model2.fit(X_train, y_train)</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model on the testing set</span></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>score <span class="op">=</span> model2.score(X_test, y_test)</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Decision Tree Accuracy: </span><span class="sc">{:.2f}</span><span class="st">%"</span>.<span class="bu">format</span>(score <span class="op">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Decision Tree Accuracy: 85.39%</code></pre>
</div>
</div>
<pre><code>Random Forest: Random forest is an ensemble learning algorithm that combines the outputs of multiple decision trees to produce a more accurate prediction. In this case, we would use a random forest to improve the accuracy of our model for predicting survival on the Titanic.</code></pre>
<div class="cell" data-execution_count="299">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the necessary libraries</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train a random forest model</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>model3 <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>model3.fit(X_train, y_train)</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model on the testing set</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>score <span class="op">=</span> model3.score(X_test, y_test)</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Random Forest Accuracy: </span><span class="sc">{:.2f}</span><span class="st">%"</span>.<span class="bu">format</span>(score <span class="op">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest Accuracy: 81.46%</code></pre>
</div>
</div>
<p>Model building is just one part of the overall data analysis process. Once you have built your model, it’s important to evaluate its performance and interpret the results.</p>
<pre><code>Cross-Validation: Cross-validation is a technique used to evaluate the performance of a model by dividing the data into multiple parts, training the model on one part and testing it on the others. This helps to reduce the risk of overfitting, where a model performs well on the training data but poorly on new data.</code></pre>
<div class="cell" data-execution_count="300">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the necessary libraries</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model using cross-validation</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>scores1 <span class="op">=</span> cross_val_score(model1, X, y, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>scores2 <span class="op">=</span> cross_val_score(model2, X, y, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>scores3 <span class="op">=</span> cross_val_score(model3, X, y, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" Logistic Regression Accuracy: </span><span class="sc">{:.2f}</span><span class="st">% (+/- </span><span class="sc">{:.2f}</span><span class="st">%)"</span>.<span class="bu">format</span>(scores1.mean() <span class="op">*</span> <span class="dv">100</span>, scores1.std() <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> <span class="dv">100</span>))</span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" Decison Tree Accuracy: </span><span class="sc">{:.2f}</span><span class="st">% (+/- </span><span class="sc">{:.2f}</span><span class="st">%)"</span>.<span class="bu">format</span>(scores2.mean() <span class="op">*</span> <span class="dv">100</span>, scores2.std() <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> <span class="dv">100</span>))</span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" Random Forest Accuracy: </span><span class="sc">{:.2f}</span><span class="st">% (+/- </span><span class="sc">{:.2f}</span><span class="st">%)"</span>.<span class="bu">format</span>(scores3.mean() <span class="op">*</span> <span class="dv">100</span>, scores3.std() <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Logistic Regression Accuracy: 79.14% (+/- 1.72%)
 Decison Tree Accuracy: 81.85% (+/- 3.07%)
 Random Forest Accuracy: 82.19% (+/- 5.28%)</code></pre>
</div>
</div>
<pre><code>Confusion Matrix: A confusion matrix is a table that is used to evaluate the performance of a classification model by comparing the predicted labels to the true labels. The matrix shows the number of true positives, false positives, true negatives, and false negatives, and can be used to calculate metrics such as precision, recall, and F1-score.</code></pre>
<div class="cell" data-execution_count="301">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the necessary libraries</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict the labels on the testing set</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>y_pred1 <span class="op">=</span> model1.predict(X_test)</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="op">=</span> model2.predict(X_test)</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>y_pred3 <span class="op">=</span> model3.predict(X_test)</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the confusion matrix</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>cm1 <span class="op">=</span> confusion_matrix(y_test, y_pred1)</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>cm2 <span class="op">=</span> confusion_matrix(y_test, y_pred2)</span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>cm3 <span class="op">=</span> confusion_matrix(y_test, y_pred3)</span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Logistic Regression"</span>)</span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm1)</span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Decision Tree"</span>)</span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm2)</span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Random Forest"</span>)</span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression
[[97 20]
 [21 40]]

Decision Tree
[[109   8]
 [ 18  43]]

Random Forest
[[98 19]
 [14 47]]</code></pre>
</div>
</div>
<pre><code>ROC Curve: A ROC (receiver operating characteristic) curve is a graph that is used to evaluate the performance of a binary classification model. The curve shows the trade-off between the true positive rate and false positive rate, and the area under the curve (AUC) can be used to compare the performance of different models.</code></pre>
<div class="cell" data-execution_count="302">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the necessary libraries</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict the probabilities on the testing set</span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>y_prob1 <span class="op">=</span> model1.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>y_prob2 <span class="op">=</span> model2.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>y_prob3 <span class="op">=</span> model3.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the ROC AUC score</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>auc1 <span class="op">=</span> roc_auc_score(y_test, y_prob1)</span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>auc2 <span class="op">=</span> roc_auc_score(y_test, y_prob2)</span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>auc3 <span class="op">=</span> roc_auc_score(y_test, y_prob3)</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Logistic Regression ROC AUC: </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(auc1))</span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Decision Tree ROC AUC: </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(auc2))</span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Random Forest ROC AUC: </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(auc3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression ROC AUC: 0.80

Decision Tree ROC AUC: 0.86

Random Forest ROC AUC: 0.86</code></pre>
</div>
</div>
<pre><code>Feature Importance: Feature importance is a measure of how much each feature contributes to the prediction of the target variable. This can help you to understand which features are most important in your model, and can be used to identify features that are not useful or redundant.</code></pre>
<div class="cell" data-execution_count="303">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the necessary libraries</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Train a random forest classifier</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>model.fit(X, y)</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the feature importances</span></span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>importances <span class="op">=</span> model.feature_importances_</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the feature importances</span></span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>importance_df <span class="op">=</span> pd.DataFrame({<span class="st">'Feature'</span>: X.columns, <span class="st">'Importance'</span>: importances})</span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>importance_df <span class="op">=</span> importance_df.sort_values(<span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>importance_df.plot(kind<span class="op">=</span><span class="st">'bar'</span>, x<span class="op">=</span><span class="st">'Feature'</span>, y<span class="op">=</span><span class="st">'Importance'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="303">
<pre><code>&lt;AxesSubplot: xlabel='Feature'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-145-output-2.png" class="img-fluid"></p>
</div>
</div>
<pre><code>Learning Curve: A learning curve is a graph that shows the relationship between the training size and the training and testing error of a model. This can help you to understand if your model is overfitting or underfitting, and can be used to identify if you need to increase the size of your training data or if you need to use a more complex model.</code></pre>
<div class="cell" data-execution_count="304">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the necessary libraries</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> learning_curve</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the learning curve</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>train_sizes, train_scores, test_scores <span class="op">=</span> learning_curve(model, X, y)</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the learning curve</span></span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>plt.plot(train_sizes, train_scores.mean(axis<span class="op">=</span><span class="dv">1</span>), <span class="st">'o-'</span>, label<span class="op">=</span><span class="st">'Training Error'</span>)</span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>plt.plot(train_sizes, test_scores.mean(axis<span class="op">=</span><span class="dv">1</span>), <span class="st">'o-'</span>, label<span class="op">=</span><span class="st">'Testing Error'</span>)</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Training Size'</span>)</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Error'</span>)</span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="304">
<pre><code>&lt;matplotlib.legend.Legend at 0x1f4d58ad730&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-146-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="absent-from-work" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="absent-from-work"><span class="header-section-number">11</span> Absent from Work</h2>
<section id="import-and-read-data" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="import-and-read-data"><span class="header-section-number">11.1</span> 0 Import and Read Data</h3>
<p>The taset can be found at the following url-</p>
<p>https://archive.ics.uci.edu/ml/datasets/Absenteeism+at+work</p>
<p>The dataset consists of records of absenteeism at work from July 2007 to July 2010 at a courier company in Brazil. The dataset contains 740 number of instances and 21 number of attributes.</p>
<p>It was created by Andrea Martiniano, Ricardo Pinto Ferreira and Renato Jose Sassi.</p>
<p>Attribute information in the dataset is as follows:-</p>
<ol type="1">
<li><p>ID – represents individual identification ID</p></li>
<li><p>Reason for absence (ICD) –</p>
<p>Absences attested by the International Code of Diseases (ICD) stratified into 21 categories (I to XXI) as follows:</p>
<p>I Certain infectious and parasitic diseases</p>
<p>II Neoplasms</p>
<p>III Diseases of the blood and blood-forming organs and certain disorders involving the immune mechanism</p>
<p>IV Endocrine, nutritional and metabolic diseases</p>
<p>V Mental and behavioural disorders</p>
<p>VI Diseases of the nervous system</p>
<p>VII Diseases of the eye and adnexa</p>
<p>VIII Diseases of the ear and mastoid process</p>
<p>IX Diseases of the circulatory system</p>
<p>X Diseases of the respiratory system</p>
<p>XI Diseases of the digestive system</p>
<p>XII Diseases of the skin and subcutaneous tissue</p>
<p>XIII Diseases of the musculoskeletal system and connective tissue</p>
<p>XIV Diseases of the genitourinary system</p>
<p>XV Pregnancy, childbirth and the puerperium</p>
<p>XVI Certain conditions originating in the perinatal period</p>
<p>XVII Congenital malformations, deformations and chromosomal abnormalities</p>
<p>XVIII Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified</p>
<p>XIX Injury, poisoning and certain other consequences of external causes</p>
<p>XX External causes of morbidity and mortality</p>
<p>XXI Factors influencing health status and contact with health services.</p>
<p>And 7 categories without (CID) patient follow-up (22), medical consultation (23), blood donation (24), laboratory examination (25), unjustified absence (26), physiotherapy (27), dental consultation (28).</p></li>
<li><p>Month of absence</p></li>
<li><p>Day of the week (Monday (2), Tuesday (3), Wednesday (4), Thursday (5), Friday (6))</p></li>
<li><p>Seasons (summer (1), autumn (2), winter (3), spring (4))</p></li>
<li><p>Transportation expense</p></li>
<li><p>Distance from Residence to Work (kilometers)</p></li>
<li><p>Service time</p></li>
<li><p>Age</p></li>
<li><p>Work load Average/day</p></li>
<li><p>Hit target</p></li>
<li><p>Disciplinary failure (yes=1; no=0)</p></li>
<li><p>Education (high school (1), graduate (2), postgraduate (3), master and doctor (4))</p></li>
<li><p>Son (number of children)</p></li>
<li><p>Social drinker (yes=1; no=0)</p></li>
<li><p>Social smoker (yes=1; no=0)</p></li>
<li><p>Pet (number of pet)</p></li>
<li><p>Weight</p></li>
<li><p>Height</p></li>
<li><p>Body mass index</p></li>
<li><p>Absenteeism time in hours (target)</p></li>
</ol>
<div class="cell" data-execution_count="305">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> st</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="306">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">"whitegrid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can import the dataset using the usual <strong>read_csv()</strong> function as follows:-</p>
<div class="cell" data-execution_count="307">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/Dong2Yo/Dataset/main/Absenteeism_at_work_AAA/Absenteeism_at_work.csv"</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(data, sep<span class="op">=</span><span class="st">";"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Generally, in the csv file the values are separated by a comma. So, there is no need to use the sep parameter which describes how the values are separated.</p>
<p>In this case, the values are separated by semicolon (;). So, we can use the <strong>sep = “;”</strong> parameter to denote that the values are separated by semicolon.</p>
<p>Overview of the dataset</p>
<p>Now, we should get to know our data. We should know its dimensions, structure and column data types.</p>
<p><strong>df.shape attribute</strong></p>
<div class="cell" data-execution_count="308">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(740, 21)</code></pre>
</div>
</div>
<p><strong>df.columns attribute</strong></p>
<div class="cell" data-execution_count="309">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['ID', 'Reason for absence', 'Month of absence', 'Day of the week',
       'Seasons', 'Transportation expense', 'Distance from Residence to Work',
       'Service time', 'Age', 'Work load Average/day ', 'Hit target',
       'Disciplinary failure', 'Education', 'Son', 'Social drinker',
       'Social smoker', 'Pet', 'Weight', 'Height', 'Body mass index',
       'Absenteeism time in hours'],
      dtype='object')</code></pre>
</div>
</div>
<p><strong>df.head() and df.tail() methods</strong></p>
<div class="cell" data-execution_count="310">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="310">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Reason for absence</th>
      <th>Month of absence</th>
      <th>Day of the week</th>
      <th>Seasons</th>
      <th>Transportation expense</th>
      <th>Distance from Residence to Work</th>
      <th>Service time</th>
      <th>Age</th>
      <th>Work load Average/day</th>
      <th>...</th>
      <th>Disciplinary failure</th>
      <th>Education</th>
      <th>Son</th>
      <th>Social drinker</th>
      <th>Social smoker</th>
      <th>Pet</th>
      <th>Weight</th>
      <th>Height</th>
      <th>Body mass index</th>
      <th>Absenteeism time in hours</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>26</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>289</td>
      <td>36</td>
      <td>13</td>
      <td>33</td>
      <td>239.554</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>90</td>
      <td>172</td>
      <td>30</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36</td>
      <td>0</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>118</td>
      <td>13</td>
      <td>18</td>
      <td>50</td>
      <td>239.554</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>98</td>
      <td>178</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>23</td>
      <td>7</td>
      <td>4</td>
      <td>1</td>
      <td>179</td>
      <td>51</td>
      <td>18</td>
      <td>38</td>
      <td>239.554</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>89</td>
      <td>170</td>
      <td>31</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>5</td>
      <td>1</td>
      <td>279</td>
      <td>5</td>
      <td>14</td>
      <td>39</td>
      <td>239.554</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>68</td>
      <td>168</td>
      <td>24</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11</td>
      <td>23</td>
      <td>7</td>
      <td>5</td>
      <td>1</td>
      <td>289</td>
      <td>36</td>
      <td>13</td>
      <td>33</td>
      <td>239.554</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>90</td>
      <td>172</td>
      <td>30</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="311">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>df.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="311">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Reason for absence</th>
      <th>Month of absence</th>
      <th>Day of the week</th>
      <th>Seasons</th>
      <th>Transportation expense</th>
      <th>Distance from Residence to Work</th>
      <th>Service time</th>
      <th>Age</th>
      <th>Work load Average/day</th>
      <th>...</th>
      <th>Disciplinary failure</th>
      <th>Education</th>
      <th>Son</th>
      <th>Social drinker</th>
      <th>Social smoker</th>
      <th>Pet</th>
      <th>Weight</th>
      <th>Height</th>
      <th>Body mass index</th>
      <th>Absenteeism time in hours</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>735</th>
      <td>11</td>
      <td>14</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>289</td>
      <td>36</td>
      <td>13</td>
      <td>33</td>
      <td>264.604</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>90</td>
      <td>172</td>
      <td>30</td>
      <td>8</td>
    </tr>
    <tr>
      <th>736</th>
      <td>1</td>
      <td>11</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>235</td>
      <td>11</td>
      <td>14</td>
      <td>37</td>
      <td>264.604</td>
      <td>...</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>88</td>
      <td>172</td>
      <td>29</td>
      <td>4</td>
    </tr>
    <tr>
      <th>737</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>118</td>
      <td>14</td>
      <td>13</td>
      <td>40</td>
      <td>271.219</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>8</td>
      <td>98</td>
      <td>170</td>
      <td>34</td>
      <td>0</td>
    </tr>
    <tr>
      <th>738</th>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>231</td>
      <td>35</td>
      <td>14</td>
      <td>39</td>
      <td>271.219</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>100</td>
      <td>170</td>
      <td>35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>739</th>
      <td>35</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>3</td>
      <td>179</td>
      <td>45</td>
      <td>14</td>
      <td>53</td>
      <td>271.219</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>77</td>
      <td>175</td>
      <td>25</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<p><strong>df.info() method</strong></p>
<div class="cell" data-execution_count="312">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 740 entries, 0 to 739
Data columns (total 21 columns):
 #   Column                           Non-Null Count  Dtype  
---  ------                           --------------  -----  
 0   ID                               740 non-null    int64  
 1   Reason for absence               740 non-null    int64  
 2   Month of absence                 740 non-null    int64  
 3   Day of the week                  740 non-null    int64  
 4   Seasons                          740 non-null    int64  
 5   Transportation expense           740 non-null    int64  
 6   Distance from Residence to Work  740 non-null    int64  
 7   Service time                     740 non-null    int64  
 8   Age                              740 non-null    int64  
 9   Work load Average/day            740 non-null    float64
 10  Hit target                       740 non-null    int64  
 11  Disciplinary failure             740 non-null    int64  
 12  Education                        740 non-null    int64  
 13  Son                              740 non-null    int64  
 14  Social drinker                   740 non-null    int64  
 15  Social smoker                    740 non-null    int64  
 16  Pet                              740 non-null    int64  
 17  Weight                           740 non-null    int64  
 18  Height                           740 non-null    int64  
 19  Body mass index                  740 non-null    int64  
 20  Absenteeism time in hours        740 non-null    int64  
dtypes: float64(1), int64(20)
memory usage: 121.5 KB</code></pre>
</div>
</div>
<p>The data types of several columns like “Month of absence”, “Transportation expense”, “Distance from Residence to work”, “Hit target”, “Education”, “Weight”, “Height”, “Body mass index” and “Absenteeism time in hours” should be real or float. But, the above cell shows that they have integer data types. So, we need to convert their data types into float.</p>
</section>
<section id="clean-data" class="level3" data-number="11.2">
<h3 data-number="11.2" class="anchored" data-anchor-id="clean-data"><span class="header-section-number">11.2</span> 1 Clean Data</h3>
<div class="cell" data-execution_count="313">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">"Month of absence"</span>,<span class="st">"Transportation expense"</span>,<span class="st">"Distance from Residence to Work"</span>, <span class="st">"Hit target"</span>,<span class="st">"Education"</span>,<span class="st">"Weight"</span>,<span class="st">"Height"</span>,</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="st">"Body mass index"</span>,<span class="st">"Absenteeism time in hours"</span>]]<span class="op">=</span>df[[<span class="st">"Month of absence"</span>,<span class="st">"Transportation expense"</span>,<span class="st">"Distance from Residence to Work"</span>,</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="st">"Hit target"</span>,<span class="st">"Education"</span>,<span class="st">"Weight"</span>,<span class="st">"Height"</span>,<span class="st">"Body mass index"</span>,<span class="st">"Absenteeism time in hours"</span>]].astype(<span class="bu">float</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="314">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 740 entries, 0 to 739
Data columns (total 21 columns):
 #   Column                           Non-Null Count  Dtype  
---  ------                           --------------  -----  
 0   ID                               740 non-null    int64  
 1   Reason for absence               740 non-null    int64  
 2   Month of absence                 740 non-null    float64
 3   Day of the week                  740 non-null    int64  
 4   Seasons                          740 non-null    int64  
 5   Transportation expense           740 non-null    float64
 6   Distance from Residence to Work  740 non-null    float64
 7   Service time                     740 non-null    int64  
 8   Age                              740 non-null    int64  
 9   Work load Average/day            740 non-null    float64
 10  Hit target                       740 non-null    float64
 11  Disciplinary failure             740 non-null    int64  
 12  Education                        740 non-null    float64
 13  Son                              740 non-null    int64  
 14  Social drinker                   740 non-null    int64  
 15  Social smoker                    740 non-null    int64  
 16  Pet                              740 non-null    int64  
 17  Weight                           740 non-null    float64
 18  Height                           740 non-null    float64
 19  Body mass index                  740 non-null    float64
 20  Absenteeism time in hours        740 non-null    float64
dtypes: float64(10), int64(11)
memory usage: 121.5 KB</code></pre>
</div>
</div>
<p>We can see that the data types of modified columns are float64. Now, all the columns are appropriate data types.</p>
<p><strong>drop redundant columns</strong></p>
<p>There are two columns <code>ID</code> and <code>Pet</code> which have no correlation with the target variable <code>Absenteeism time in hours</code>. So, we should drop these columns.</p>
<div class="cell" data-execution_count="315">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>df.drop([<span class="st">'ID'</span>,<span class="st">'Pet'</span>], axis <span class="op">=</span> <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>df.describe() method</strong></p>
<div class="cell" data-execution_count="316">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       Reason for absence  Month of absence  Day of the week     Seasons  \
count          740.000000        740.000000       740.000000  740.000000   
mean            19.216216          6.324324         3.914865    2.544595   
std              8.433406          3.436287         1.421675    1.111831   
min              0.000000          0.000000         2.000000    1.000000   
25%             13.000000          3.000000         3.000000    2.000000   
50%             23.000000          6.000000         4.000000    3.000000   
75%             26.000000          9.000000         5.000000    4.000000   
max             28.000000         12.000000         6.000000    4.000000   

       Transportation expense  Distance from Residence to Work  Service time  \
count              740.000000                       740.000000    740.000000   
mean               221.329730                        29.631081     12.554054   
std                 66.952223                        14.836788      4.384873   
min                118.000000                         5.000000      1.000000   
25%                179.000000                        16.000000      9.000000   
50%                225.000000                        26.000000     13.000000   
75%                260.000000                        50.000000     16.000000   
max                388.000000                        52.000000     29.000000   

              Age  Work load Average/day   Hit target  Disciplinary failure  \
count  740.000000              740.000000  740.000000            740.000000   
mean    36.450000              271.490235   94.587838              0.054054   
std      6.478772               39.058116    3.779313              0.226277   
min     27.000000              205.917000   81.000000              0.000000   
25%     31.000000              244.387000   93.000000              0.000000   
50%     37.000000              264.249000   95.000000              0.000000   
75%     40.000000              294.217000   97.000000              0.000000   
max     58.000000              378.884000  100.000000              1.000000   

        Education         Son  Social drinker  Social smoker      Weight  \
count  740.000000  740.000000      740.000000     740.000000  740.000000   
mean     1.291892    1.018919        0.567568       0.072973   79.035135   
std      0.673238    1.098489        0.495749       0.260268   12.883211   
min      1.000000    0.000000        0.000000       0.000000   56.000000   
25%      1.000000    0.000000        0.000000       0.000000   69.000000   
50%      1.000000    1.000000        1.000000       0.000000   83.000000   
75%      1.000000    2.000000        1.000000       0.000000   89.000000   
max      4.000000    4.000000        1.000000       1.000000  108.000000   

           Height  Body mass index  Absenteeism time in hours  
count  740.000000       740.000000                 740.000000  
mean   172.114865        26.677027                   6.924324  
std      6.034995         4.285452                  13.330998  
min    163.000000        19.000000                   0.000000  
25%    169.000000        24.000000                   2.000000  
50%    170.000000        25.000000                   3.000000  
75%    172.000000        31.000000                   8.000000  
max    196.000000        38.000000                 120.000000  </code></pre>
</div>
</div>
<p>We can see that the minimum value of <strong>Month of absence</strong> is zero. It cannot be zero. The minimum value should be one. So, we need to replace zero by one.</p>
<div class="cell" data-execution_count="317">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Month of absence'</span>].replace(<span class="dv">0</span>,<span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="318">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       Reason for absence  Month of absence  Day of the week     Seasons  \
count          740.000000        740.000000       740.000000  740.000000   
mean            19.216216          6.328378         3.914865    2.544595   
std              8.433406          3.429397         1.421675    1.111831   
min              0.000000          1.000000         2.000000    1.000000   
25%             13.000000          3.000000         3.000000    2.000000   
50%             23.000000          6.000000         4.000000    3.000000   
75%             26.000000          9.000000         5.000000    4.000000   
max             28.000000         12.000000         6.000000    4.000000   

       Transportation expense  Distance from Residence to Work  Service time  \
count              740.000000                       740.000000    740.000000   
mean               221.329730                        29.631081     12.554054   
std                 66.952223                        14.836788      4.384873   
min                118.000000                         5.000000      1.000000   
25%                179.000000                        16.000000      9.000000   
50%                225.000000                        26.000000     13.000000   
75%                260.000000                        50.000000     16.000000   
max                388.000000                        52.000000     29.000000   

              Age  Work load Average/day   Hit target  Disciplinary failure  \
count  740.000000              740.000000  740.000000            740.000000   
mean    36.450000              271.490235   94.587838              0.054054   
std      6.478772               39.058116    3.779313              0.226277   
min     27.000000              205.917000   81.000000              0.000000   
25%     31.000000              244.387000   93.000000              0.000000   
50%     37.000000              264.249000   95.000000              0.000000   
75%     40.000000              294.217000   97.000000              0.000000   
max     58.000000              378.884000  100.000000              1.000000   

        Education         Son  Social drinker  Social smoker      Weight  \
count  740.000000  740.000000      740.000000     740.000000  740.000000   
mean     1.291892    1.018919        0.567568       0.072973   79.035135   
std      0.673238    1.098489        0.495749       0.260268   12.883211   
min      1.000000    0.000000        0.000000       0.000000   56.000000   
25%      1.000000    0.000000        0.000000       0.000000   69.000000   
50%      1.000000    1.000000        1.000000       0.000000   83.000000   
75%      1.000000    2.000000        1.000000       0.000000   89.000000   
max      4.000000    4.000000        1.000000       1.000000  108.000000   

           Height  Body mass index  Absenteeism time in hours  
count  740.000000       740.000000                 740.000000  
mean   172.114865        26.677027                   6.924324  
std      6.034995         4.285452                  13.330998  
min    163.000000        19.000000                   0.000000  
25%    169.000000        24.000000                   2.000000  
50%    170.000000        25.000000                   3.000000  
75%    172.000000        31.000000                   8.000000  
max    196.000000        38.000000                 120.000000  </code></pre>
</div>
</div>
<p><strong>Check for anomalies in the dataset</strong></p>
<p><u>Check for missing numerical values</u></p>
<p>The first step is to check for any missing values in the dataset. We can check for missing values in the dataset using the <code>df.isnull().sum()</code> command. This command returns the total number of missing values in each column in the dataset.</p>
<p>If we want to check for ‘NA’ values in a particular column in the dataframe, then we should use the following command <code>pd.isna(df['col_name'])</code>.</p>
<div class="cell" data-execution_count="319">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="319">
<pre><code>Reason for absence                 0
Month of absence                   0
Day of the week                    0
Seasons                            0
Transportation expense             0
Distance from Residence to Work    0
Service time                       0
Age                                0
Work load Average/day              0
Hit target                         0
Disciplinary failure               0
Education                          0
Son                                0
Social drinker                     0
Social smoker                      0
Weight                             0
Height                             0
Body mass index                    0
Absenteeism time in hours          0
dtype: int64</code></pre>
</div>
</div>
<p><u>Check with ASSERT statement</u></p>
<p>We should confirm that our dataset has no missing values. We can write an <strong>assert statement</strong> to verify this. We can use an <strong>assert statement</strong> to programmatically check that no missing, unexpected 0 or negative values are present. This gives us confidence that our code is running properly.</p>
<p>Assert statement will return nothing if the value being tested is true and will throw an AssertionError if the value is false.</p>
<p>Asserts</p>
<p>• assert 1 == 1 (return Nothing if the value is True)</p>
<p>• assert 1 == 2 (return AssertionError if the value is False)</p>
<div class="cell" data-execution_count="320">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co">#assert that there are no missing values in the dataframe</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> pd.notnull(df).<span class="bu">all</span>().<span class="bu">all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="321">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co">#assert all values are greater than or equal to 0</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> (df <span class="op">&gt;=</span> <span class="dv">0</span>).<span class="bu">all</span>().<span class="bu">all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The above two commands do not throw any error. Hence, it is confirmed that there are no missing or negative values in the dataset. All the values are greater than or equal to zero.</p>
</section>
<section id="univariate-analysis" class="level3" data-number="11.3">
<h3 data-number="11.3" class="anchored" data-anchor-id="univariate-analysis"><span class="header-section-number">11.3</span> 2 Univariate Analysis</h3>
<p><u>Measures of central tendency and dispersion</u></p>
<p><strong>Central tendency</strong> means a central value which describe a probability distribution. It may also be called a center or location of the distribution. The most common measures of central tendency are the arithmetic mean, the median and the mode. The most common measure of central tendency is the mean. For skewed distribution or when there is concern about outliers, the median may be preferred. So, median is more robust measure than the mean.</p>
<p><strong>Dispersion</strong> is an indicator of how far away from the center, we can find the data values. The most common measures of dispersion are variance, standard deviation and interquartile range(IQR). Variance is the standard measure of spread. The standard deviation is the square root of the variance. The variance and standard deviation are two useful measures of spread.</p>
<p>A third measure of spread is the interquartile range (IQR). The IQR is calculated using the boundaries of data situated between the 1st and the 3rd quartiles. So, IQR can be calculated as IQR = Q3 - Q1. It is a robust measure of spread.</p>
<div class="cell" data-execution_count="322">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'Absenteeism time in hours'</span>].describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>count    740.000000
mean       6.924324
std       13.330998
min        0.000000
25%        2.000000
50%        3.000000
75%        8.000000
max      120.000000
Name: Absenteeism time in hours, dtype: float64</code></pre>
</div>
</div>
<p><strong>Interpretation</strong></p>
<p>The count, min and max values represent the number of counts, minimum and maximum values of the target variable <code>Absenteeism time in hours</code>.</p>
<p>The measures of central tendency are given by the mean(6.924324) and median(50% value-3.00).</p>
<p>The measure of dispersion is given by the standard deviation given by std(13.330998).</p>
<p>The 25%, 50% and 75% values show the corresponding percentiles. 50th percentile denote the median of the distribution.</p>
<p>The IQR is the difference between 75th and 25th percentiles. Hence, IQR = 8.00 - 2.00 = 6.00</p>
<p><u>Measures of shape</u></p>
<p>We have looked at the measures of central tendency of the data (mean and median) and spread of the data (standard deviation(std), interquartile range, minimum (min) and maximum (max) values. These quantities can only be used for quantitative variables not for categorical variables.</p>
<p>Now, we will take a look at measures of shape of distribution. There are two statistical measures that can tell us about the shape of the distribution. These measures are <strong>skewness</strong> and <strong>kurtosis</strong>. These measures can be used to convey information about the shape of the distribution of the dataset.</p>
<p>First, we will look at skewness and later we get to know about kurtosis.</p>
<p><u>Skewness</u></p>
<p>Skewness is a measure of a distribution’s symmetry or more precisely lack of symmetry. It is used to mean the absence of symmetry from the mean of the dataset. It is a characteristic of the deviation from the mean. It is used to indicate the shape of the distribution of data.</p>
<p><u>Negative skewness</u></p>
<p>Negative values for skewness indicate negative skewness. In this case, the data are skewed or tail to left. By skewed left, we mean that the left tail is long relative to the right tail. The data values may extend further to the left but concentrated in the right. So, there is a long tail and distortion is caused by extremely small values which pull the mean downward so that it is less than the median. Hence, in this case</p>
<p><strong>Mean &lt; Median &lt; Mode</strong></p>
<p><u>Zero skewness</u></p>
<p>Zero skewness means skewness value of zero. It means the dataset is symmetrical. A data set is symmetrical if it looks the same to the left and right to the center point. The dataset looks bell shaped or symmetrical. A perfectly symmetrical data set will have a skewness of zero. So, the normal distribution which is perfectly symmetrical has a skewness of 0. So, in this case</p>
<p><strong>Mean = Median = Mode</strong></p>
<p><u>Positive skewness</u></p>
<p>Positive values for skewness indicate positive skewness. The dataset are skewed or tail to right. By skewed right, we mean that the right tail is long relative to the left tail. The data values are concentrated in the right. So, there is a long tail to the right that is caused by extremely large values which pull the mean upward so that it is greater than the median. So, we have</p>
<p><strong>Mean &gt; Median &gt; Mode</strong></p>
<p><u>Reference range on skewness values</u></p>
<p>The rule of thumb for skewness values are:</p>
<p>If the skewness is between -0.5 and 0.5, the data are fairly symmetrical.</p>
<p>If the skewness is between -1 and – 0.5 or between 0.5 and 1, the data are moderately skewed.</p>
<p>If the skewness is less than -1 or greater than 1, the data are highly skewed.</p>
<div class="cell" data-execution_count="323">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Absenteeism time in hours'</span>].skew()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="323">
<pre><code>5.720727863123873</code></pre>
</div>
</div>
<p>The skewness of our target variable <code>Absenteeism time in hours</code> comes out to be greater than +1. So, we can conclude that the target variable is highly positively skewed.</p>
<p>We can confirm this by plotting a Seaborn histplot diagram.</p>
<div class="cell" data-execution_count="324">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span> (<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>sns.displot(df[<span class="st">"Absenteeism time in hours"</span>])</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Distribution of Absenteeism time in hours"</span>)</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1000x800 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-166-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The above plot confirms that the target variable <code>Absenteeism time in hours</code> is highly positively skewed.</p>
<p><u>Kurtosis</u></p>
<p>Kurtosis is the degree of peakedness of a distribution.</p>
<p>Data sets with high kurtosis tend to have a distinct peak near the mean, decline rather rapidly and have heavy tails.</p>
<p>Data sets with low kurtosis tend to have a flat top near the mean rather than a sharp peak.</p>
<p><strong>Reference range for kurtosis</strong></p>
<p>The reference standard is a normal distribution, which has a kurtosis of 3. Often, <strong>excess kurtosis</strong> is presented instead of kurtosis, where <strong>excess kurtosis</strong> is simply <strong>kurtosis - 3</strong>.</p>
<p><strong>Mesokurtic curve</strong></p>
<p>A normal distribution has kurtosis exactly 3 (<strong>excess kurtosis</strong> exactly 0). Any distribution with kurtosis ≈3 (excess ≈ 0) is called <strong>mesokurtic</strong>.</p>
<p><strong>Platykurtic curve</strong></p>
<p>A distribution with kurtosis &lt; 3 (<strong>excess kurtosis</strong> &lt; 0) is called <strong>platykurtic</strong>. As compared to a normal distribution, its central peak is lower and broader, and its tails are shorter and thinner.</p>
<p><strong>Leptokurtic curve</strong></p>
<p>A distribution with kurtosis &gt; 3 (<strong>excess kurtosis</strong> &gt; 0) is called <strong>leptokurtic</strong>. As compared to a normal distribution, its central peak is higher and sharper, and its tails are longer and fatter.</p>
<div class="cell" data-execution_count="325">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Absenteeism time in hours'</span>].kurt()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="325">
<pre><code>38.77730707753998</code></pre>
</div>
</div>
<p>The kurtosis value of the <code>Absenteeism time in hours</code> is much much greater than 3. So, we can conclude that the distribution curve is a <strong>Leptokurtic curve</strong>. Its central peak is higher and sharper and its tails are longer and fatter.</p>
<p><u>Findings of univariate analysis</u></p>
<p>Findings of univariate analysis are as follows:-</p>
<p>• The target variable <code>Absenteeism time in hours</code> is highly positively skewed.</p>
<p>• Its distribution curve is a <strong>Leptokurtic curve</strong>. Its central peak is higher and sharper and its tails are longer and fatter.</p>
</section>
<section id="multivariate-analysis" class="level3" data-number="11.4">
<h3 data-number="11.4" class="anchored" data-anchor-id="multivariate-analysis"><span class="header-section-number">11.4</span> 3 Multivariate Analysis</h3>
<p><u>Examine relationship between target variable and categorical attributes</u></p>
<p>In the dataset, we have several categorical attributes like <code>Seasons</code>, <code>Education</code>, <code>Social drinker</code> and <code>Social smoker</code>. We can explore the relationship between these categorical attributes and target variable.</p>
<p><code>Seasons</code> is a categorical attribute. We can find out what categories exist and how many values belong to each category using the <code>value_counts()</code> method.</p>
<div class="cell" data-execution_count="326">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Seasons'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="326">
<pre><code>4    195
2    192
3    183
1    170
Name: Seasons, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="327">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>bar_colors <span class="op">=</span> [<span class="st">'green'</span>, <span class="st">'grey'</span>, <span class="st">'brown'</span>, <span class="st">'orange'</span>]</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Seasons'</span>].value_counts().plot(kind <span class="op">=</span> <span class="st">'bar'</span>, color<span class="op">=</span>bar_colors, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Absenteeism time in hours in various seasons'</span>)</span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Seasons'</span>)</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Absenteeism time in hours'</span>)</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-169-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p><code>Seasons</code> attribute contain 4 data values as 1, 2, 3 and 4. These values represent 4 different seasons in a year which are coded as summer = 1, autumn = 2, winter = 3, spring = 4. So, we can conclude that spring contains highest number of <code>Absenteeism time in hours</code>.</p>
<p>Similarly, <code>Education</code>, <code>Social drinker</code> and <code>Social smoker</code> are also categorical attributes. We can visualize their frequency distribution using the value_counts() method and visualize them as follows:-</p>
<div class="cell" data-execution_count="328">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Education'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="328">
<pre><code>1.0    611
3.0     79
2.0     46
4.0      4
Name: Education, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="329">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Education'</span>].value_counts().plot(kind <span class="op">=</span> <span class="st">'bar'</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Absenteeism time in hours in various seasons'</span>)</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Education'</span>)</span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Absenteeism time in hours'</span>)</span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-171-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>Education categorical attribute is coded as 1.0, 2.0, 3.0 and 4.0 which stands for different categories. The categories are high school (1), graduate (2), postgraduate (3), master and doctor (4). We can see that the high school category consists of highest number of <code>Absenteeism time in hours</code>.</p>
<div class="cell" data-execution_count="330">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Social drinker'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="330">
<pre><code>1    420
0    320
Name: Social drinker, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="331">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Social drinker'</span>].value_counts().plot(kind <span class="op">=</span> <span class="st">'bar'</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Absenteeism time in hours in various seasons'</span>)</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Social drinker'</span>)</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Absenteeism time in hours'</span>)</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-173-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>Social drinker consists of two categories - (yes=1; no=0). From the graph, we can conclude that <code>Social drinker</code> have higher number of <code>Absenteeism time in hours</code>.</p>
<div class="cell" data-execution_count="332">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Social smoker'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="332">
<pre><code>0    686
1     54
Name: Social smoker, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="333">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Social smoker'</span>].value_counts().plot(kind <span class="op">=</span> <span class="st">'bar'</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Absenteeism time in hours in various seasons'</span>)</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Social smoker'</span>)</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Absenteeism time in hours'</span>)</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-175-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>Social smoker consists of two categories - (yes=1; no=0). From the graph, we can conclude that <code>Social smoker</code> have lesser number of <code>Absenteeism time in hours</code>.</p>
<p><u>Initial Findings of multivariate analysis</u></p>
<p>Findings of multivariate analysis are as follows:-</p>
<p>• The spring season contains highest number of <code>Absenteeism time in hours</code>.</p>
<p>• The high school category consists of highest number of <code>Absenteeism time in hours</code>.</p>
<p>• The <code>Social drinker</code> category have higher number of <code>Absenteeism time in hours</code>.</p>
<p>• The <code>Social smoker</code> category have lesser number of <code>Absenteeism time in hours</code>.</p>
<p><strong>Estimating correlation coefficients</strong></p>
<p>Our dataset is very small. So, we can compute the standard correlation coefficient (also called Pearson’s r) between every pair of attributes. We can compute it using the <code>df.corr()</code> method.</p>
<div class="cell" data-execution_count="334">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>correlation <span class="op">=</span> df.corr()</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>correlation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="334">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Reason for absence</th>
      <th>Month of absence</th>
      <th>Day of the week</th>
      <th>Seasons</th>
      <th>Transportation expense</th>
      <th>Distance from Residence to Work</th>
      <th>Service time</th>
      <th>Age</th>
      <th>Work load Average/day</th>
      <th>Hit target</th>
      <th>Disciplinary failure</th>
      <th>Education</th>
      <th>Son</th>
      <th>Social drinker</th>
      <th>Social smoker</th>
      <th>Weight</th>
      <th>Height</th>
      <th>Body mass index</th>
      <th>Absenteeism time in hours</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reason for absence</th>
      <td>1.000000</td>
      <td>-0.086724</td>
      <td>0.116319</td>
      <td>-0.117925</td>
      <td>-0.119381</td>
      <td>0.161831</td>
      <td>0.048425</td>
      <td>-0.078608</td>
      <td>-0.123472</td>
      <td>0.088943</td>
      <td>-0.545054</td>
      <td>-0.047357</td>
      <td>-0.055364</td>
      <td>0.065441</td>
      <td>-0.115702</td>
      <td>-0.000269</td>
      <td>-0.079267</td>
      <td>0.037205</td>
      <td>-0.173116</td>
    </tr>
    <tr>
      <th>Month of absence</th>
      <td>-0.086724</td>
      <td>1.000000</td>
      <td>-0.006193</td>
      <td>0.408009</td>
      <td>0.136999</td>
      <td>-0.003759</td>
      <td>-0.062688</td>
      <td>-0.000143</td>
      <td>-0.170339</td>
      <td>-0.461249</td>
      <td>0.107880</td>
      <td>-0.066774</td>
      <td>0.079529</td>
      <td>0.056576</td>
      <td>-0.039012</td>
      <td>0.024486</td>
      <td>-0.069169</td>
      <td>0.052435</td>
      <td>0.023779</td>
    </tr>
    <tr>
      <th>Day of the week</th>
      <td>0.116319</td>
      <td>-0.006193</td>
      <td>1.000000</td>
      <td>0.046493</td>
      <td>0.033988</td>
      <td>0.118026</td>
      <td>0.021252</td>
      <td>0.004459</td>
      <td>0.015646</td>
      <td>0.030986</td>
      <td>-0.015120</td>
      <td>0.058516</td>
      <td>0.098079</td>
      <td>0.041772</td>
      <td>0.013156</td>
      <td>-0.128980</td>
      <td>-0.082133</td>
      <td>-0.103578</td>
      <td>-0.124361</td>
    </tr>
    <tr>
      <th>Seasons</th>
      <td>-0.117925</td>
      <td>0.408009</td>
      <td>0.046493</td>
      <td>1.000000</td>
      <td>0.036995</td>
      <td>-0.063108</td>
      <td>-0.010904</td>
      <td>-0.012089</td>
      <td>0.150439</td>
      <td>-0.061154</td>
      <td>0.151766</td>
      <td>-0.002951</td>
      <td>0.046950</td>
      <td>-0.045982</td>
      <td>-0.048671</td>
      <td>-0.026278</td>
      <td>-0.033737</td>
      <td>-0.011031</td>
      <td>-0.005615</td>
    </tr>
    <tr>
      <th>Transportation expense</th>
      <td>-0.119381</td>
      <td>0.136999</td>
      <td>0.033988</td>
      <td>0.036995</td>
      <td>1.000000</td>
      <td>0.262183</td>
      <td>-0.349887</td>
      <td>-0.227542</td>
      <td>0.005438</td>
      <td>-0.080193</td>
      <td>0.109222</td>
      <td>-0.055065</td>
      <td>0.383001</td>
      <td>0.145117</td>
      <td>0.044356</td>
      <td>-0.207435</td>
      <td>-0.194496</td>
      <td>-0.136517</td>
      <td>0.027585</td>
    </tr>
    <tr>
      <th>Distance from Residence to Work</th>
      <td>0.161831</td>
      <td>-0.003759</td>
      <td>0.118026</td>
      <td>-0.063108</td>
      <td>0.262183</td>
      <td>1.000000</td>
      <td>0.131730</td>
      <td>-0.145886</td>
      <td>-0.068677</td>
      <td>-0.013865</td>
      <td>-0.056527</td>
      <td>-0.259605</td>
      <td>0.054230</td>
      <td>0.452196</td>
      <td>-0.075369</td>
      <td>-0.047859</td>
      <td>-0.353372</td>
      <td>0.113772</td>
      <td>-0.088363</td>
    </tr>
    <tr>
      <th>Service time</th>
      <td>0.048425</td>
      <td>-0.062688</td>
      <td>0.021252</td>
      <td>-0.010904</td>
      <td>-0.349887</td>
      <td>0.131730</td>
      <td>1.000000</td>
      <td>0.670979</td>
      <td>-0.000668</td>
      <td>-0.007840</td>
      <td>-0.000221</td>
      <td>-0.213000</td>
      <td>-0.047128</td>
      <td>0.353141</td>
      <td>0.072424</td>
      <td>0.455975</td>
      <td>-0.053135</td>
      <td>0.499718</td>
      <td>0.019029</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>-0.078608</td>
      <td>-0.000143</td>
      <td>0.004459</td>
      <td>-0.012089</td>
      <td>-0.227542</td>
      <td>-0.145886</td>
      <td>0.670979</td>
      <td>1.000000</td>
      <td>-0.039425</td>
      <td>-0.039224</td>
      <td>0.104304</td>
      <td>-0.221882</td>
      <td>0.056984</td>
      <td>0.213183</td>
      <td>0.121738</td>
      <td>0.418730</td>
      <td>-0.062997</td>
      <td>0.470688</td>
      <td>0.065760</td>
    </tr>
    <tr>
      <th>Work load Average/day</th>
      <td>-0.123472</td>
      <td>-0.170339</td>
      <td>0.015646</td>
      <td>0.150439</td>
      <td>0.005438</td>
      <td>-0.068677</td>
      <td>-0.000668</td>
      <td>-0.039425</td>
      <td>1.000000</td>
      <td>-0.089445</td>
      <td>0.029026</td>
      <td>-0.074960</td>
      <td>0.027820</td>
      <td>-0.033713</td>
      <td>0.030968</td>
      <td>-0.038522</td>
      <td>0.103315</td>
      <td>-0.090709</td>
      <td>0.024749</td>
    </tr>
    <tr>
      <th>Hit target</th>
      <td>0.088943</td>
      <td>-0.461249</td>
      <td>0.030986</td>
      <td>-0.061154</td>
      <td>-0.080193</td>
      <td>-0.013865</td>
      <td>-0.007840</td>
      <td>-0.039224</td>
      <td>-0.089445</td>
      <td>1.000000</td>
      <td>-0.147971</td>
      <td>0.101062</td>
      <td>-0.014091</td>
      <td>-0.102480</td>
      <td>0.051254</td>
      <td>-0.044947</td>
      <td>0.093267</td>
      <td>-0.088939</td>
      <td>0.026695</td>
    </tr>
    <tr>
      <th>Disciplinary failure</th>
      <td>-0.545054</td>
      <td>0.107880</td>
      <td>-0.015120</td>
      <td>0.151766</td>
      <td>0.109222</td>
      <td>-0.056527</td>
      <td>-0.000221</td>
      <td>0.104304</td>
      <td>0.029026</td>
      <td>-0.147971</td>
      <td>1.000000</td>
      <td>-0.059298</td>
      <td>0.072096</td>
      <td>0.051838</td>
      <td>0.116748</td>
      <td>0.072225</td>
      <td>-0.010498</td>
      <td>0.079428</td>
      <td>-0.124248</td>
    </tr>
    <tr>
      <th>Education</th>
      <td>-0.047357</td>
      <td>-0.066774</td>
      <td>0.058516</td>
      <td>-0.002951</td>
      <td>-0.055065</td>
      <td>-0.259605</td>
      <td>-0.213000</td>
      <td>-0.221882</td>
      <td>-0.074960</td>
      <td>0.101062</td>
      <td>-0.059298</td>
      <td>1.000000</td>
      <td>-0.188622</td>
      <td>-0.420013</td>
      <td>0.032727</td>
      <td>-0.300574</td>
      <td>0.100977</td>
      <td>-0.366884</td>
      <td>-0.046235</td>
    </tr>
    <tr>
      <th>Son</th>
      <td>-0.055364</td>
      <td>0.079529</td>
      <td>0.098079</td>
      <td>0.046950</td>
      <td>0.383001</td>
      <td>0.054230</td>
      <td>-0.047128</td>
      <td>0.056984</td>
      <td>0.027820</td>
      <td>-0.014091</td>
      <td>0.072096</td>
      <td>-0.188622</td>
      <td>1.000000</td>
      <td>0.206376</td>
      <td>0.156088</td>
      <td>-0.139552</td>
      <td>-0.014208</td>
      <td>-0.144150</td>
      <td>0.113756</td>
    </tr>
    <tr>
      <th>Social drinker</th>
      <td>0.065441</td>
      <td>0.056576</td>
      <td>0.041772</td>
      <td>-0.045982</td>
      <td>0.145117</td>
      <td>0.452196</td>
      <td>0.353141</td>
      <td>0.213183</td>
      <td>-0.033713</td>
      <td>-0.102480</td>
      <td>0.051838</td>
      <td>-0.420013</td>
      <td>0.206376</td>
      <td>1.000000</td>
      <td>-0.111678</td>
      <td>0.378664</td>
      <td>0.169951</td>
      <td>0.323978</td>
      <td>0.065067</td>
    </tr>
    <tr>
      <th>Social smoker</th>
      <td>-0.115702</td>
      <td>-0.039012</td>
      <td>0.013156</td>
      <td>-0.048671</td>
      <td>0.044356</td>
      <td>-0.075369</td>
      <td>0.072424</td>
      <td>0.121738</td>
      <td>0.030968</td>
      <td>0.051254</td>
      <td>0.116748</td>
      <td>0.032727</td>
      <td>0.156088</td>
      <td>-0.111678</td>
      <td>1.000000</td>
      <td>-0.198511</td>
      <td>0.003271</td>
      <td>-0.196006</td>
      <td>-0.008936</td>
    </tr>
    <tr>
      <th>Weight</th>
      <td>-0.000269</td>
      <td>0.024486</td>
      <td>-0.128980</td>
      <td>-0.026278</td>
      <td>-0.207435</td>
      <td>-0.047859</td>
      <td>0.455975</td>
      <td>0.418730</td>
      <td>-0.038522</td>
      <td>-0.044947</td>
      <td>0.072225</td>
      <td>-0.300574</td>
      <td>-0.139552</td>
      <td>0.378664</td>
      <td>-0.198511</td>
      <td>1.000000</td>
      <td>0.306802</td>
      <td>0.904117</td>
      <td>0.015789</td>
    </tr>
    <tr>
      <th>Height</th>
      <td>-0.079267</td>
      <td>-0.069169</td>
      <td>-0.082133</td>
      <td>-0.033737</td>
      <td>-0.194496</td>
      <td>-0.353372</td>
      <td>-0.053135</td>
      <td>-0.062997</td>
      <td>0.103315</td>
      <td>0.093267</td>
      <td>-0.010498</td>
      <td>0.100977</td>
      <td>-0.014208</td>
      <td>0.169951</td>
      <td>0.003271</td>
      <td>0.306802</td>
      <td>1.000000</td>
      <td>-0.121049</td>
      <td>0.144420</td>
    </tr>
    <tr>
      <th>Body mass index</th>
      <td>0.037205</td>
      <td>0.052435</td>
      <td>-0.103578</td>
      <td>-0.011031</td>
      <td>-0.136517</td>
      <td>0.113772</td>
      <td>0.499718</td>
      <td>0.470688</td>
      <td>-0.090709</td>
      <td>-0.088939</td>
      <td>0.079428</td>
      <td>-0.366884</td>
      <td>-0.144150</td>
      <td>0.323978</td>
      <td>-0.196006</td>
      <td>0.904117</td>
      <td>-0.121049</td>
      <td>1.000000</td>
      <td>-0.049719</td>
    </tr>
    <tr>
      <th>Absenteeism time in hours</th>
      <td>-0.173116</td>
      <td>0.023779</td>
      <td>-0.124361</td>
      <td>-0.005615</td>
      <td>0.027585</td>
      <td>-0.088363</td>
      <td>0.019029</td>
      <td>0.065760</td>
      <td>0.024749</td>
      <td>0.026695</td>
      <td>-0.124248</td>
      <td>-0.046235</td>
      <td>0.113756</td>
      <td>0.065067</td>
      <td>-0.008936</td>
      <td>0.015789</td>
      <td>0.144420</td>
      <td>-0.049719</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Our target variable is <code>Absenteeism time in hours</code>. So, we should check how each attribute correlates with the <code>Absenteeism time in hours</code> variable.</p>
<div class="cell" data-execution_count="335">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>correlation[<span class="st">'Absenteeism time in hours'</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="335">
<pre><code>Absenteeism time in hours          1.000000
Height                             0.144420
Son                                0.113756
Age                                0.065760
Social drinker                     0.065067
Transportation expense             0.027585
Hit target                         0.026695
Work load Average/day              0.024749
Month of absence                   0.023779
Service time                       0.019029
Weight                             0.015789
Seasons                           -0.005615
Social smoker                     -0.008936
Education                         -0.046235
Body mass index                   -0.049719
Distance from Residence to Work   -0.088363
Disciplinary failure              -0.124248
Day of the week                   -0.124361
Reason for absence                -0.173116
Name: Absenteeism time in hours, dtype: float64</code></pre>
</div>
</div>
<p><strong>Interpretation of correlation coefficient</strong></p>
<p>The correlation coefficient ranges from -1 to +1.</p>
<p>When it is close to +1, this signifies that there is a strong positive correlation. So, we can see that there is a small positive correlation between <code>Absenteeism time in hours</code> and <code>Height</code>.</p>
<p>When it is clsoe to -1, it means that there is a strong negative correlation. So, there is a small negative correlation between <code>Absenteeism time in hours</code> and <code>Reason for absence</code>.</p>
<p>When it is close to 0, it means that there is no correlation. So, there is no correlation between <code>Absenteeism time in hours</code> and <code>Seasons</code>.</p>
<p><u>Discover patterns and relationships</u></p>
<p>An important step in EDA is to discover patterns and relationships between variables in the dataset. We will use the following graphs and plots to explore the patterns and relationships in the dataset.</p>
</section>
<section id="visualize-data" class="level3" data-number="11.5">
<h3 data-number="11.5" class="anchored" data-anchor-id="visualize-data"><span class="header-section-number">11.5</span> 5 Visualize Data</h3>
<p><strong>Correlation Heat Map</strong></p>
<div class="cell" data-execution_count="336">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">12</span>))</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Correlation of Attributes with Absenteeism time in hours'</span>)</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> sns.heatmap(correlation, square<span class="op">=</span><span class="va">True</span>, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'.2f'</span>, linecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>a.set_xticklabels(a.get_xticklabels(), rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>a.set_yticklabels(a.get_yticklabels(), rotation<span class="op">=</span><span class="dv">30</span>)           </span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-178-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>From the above correlation heat map, we can conclude that :-</p>
<ol type="1">
<li><p><code>Month of absence</code> and <code>Seasons</code> are positively correlated (correlation coefficient = 0.41).</p></li>
<li><p><code>Body mass index</code> and <code>Service time</code> are positively correlated (correlation coefficient = 0.50).</p></li>
<li><p>Smilarly, <code>Body mass index</code> and <code>Age</code> are positively correlated (correlation coefficient = 0.47).</p></li>
<li><p>Also, <code>Body mass index</code> and <code>Weight</code> are highly positively correlated (correlation coefficient = 0.90).</p></li>
</ol>
<p><strong>Pair Plot</strong></p>
<div class="cell" data-execution_count="337">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>num_var <span class="op">=</span> [<span class="st">'Transportation expense'</span>, <span class="st">'Distance from Residence to Work'</span>, <span class="st">'Service time'</span>, <span class="st">'Age'</span>, <span class="st">'Work load Average/day '</span>, </span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">'Absenteeism time in hours'</span>]</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>sns.pairplot(df[num_var], kind<span class="op">=</span><span class="st">'scatter'</span>, diag_kind<span class="op">=</span><span class="st">'hist'</span>)</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-179-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<ol type="1">
<li><p>The above pair plot confirms that there is strong positive correlation between <code>Service time</code> and <code>Age</code>.</p></li>
<li><p>Similarly, <code>Distance from Residence to Work</code> and <code>Transportation expense</code> are positively correlated.</p></li>
</ol>
<p><strong>Scatter Plot of Absenteeism time in hours and other variuables</strong></p>
<div class="cell" data-execution_count="338">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x<span class="op">=</span><span class="st">'Absenteeism time in hours'</span>, y<span class="op">=</span><span class="st">'Height'</span>, data<span class="op">=</span>df)</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-180-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>The above scatter-plot shows that there is a mildly positive correlation between <code>Absenteeism time in hours</code> and <code>Height</code>. Majority of data values lie below the fitted regression line.</p>
<div class="cell" data-execution_count="339">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x<span class="op">=</span><span class="st">'Absenteeism time in hours'</span>, y<span class="op">=</span><span class="st">'Son'</span>, data<span class="op">=</span>df)</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-181-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>The above scatter-plot shows that there is a weak correlation between <code>Absenteeism time in hours</code> and <code>Son</code>.</p>
<div class="cell" data-execution_count="340">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x<span class="op">=</span><span class="st">'Body mass index'</span>, y<span class="op">=</span><span class="st">'Service time'</span>, data<span class="op">=</span>df)</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-182-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>The above scatter-plot shows that there is a strong positive correlation between <code>Body mass index</code> and <code>Service time</code>. Approximately, half of the data values lie below the fitted regression line and half of the values lie above it.</p>
<p><strong>Box Plot of Absenteeism time in hours and age</strong></p>
<div class="cell" data-execution_count="341">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>]<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">5</span>)</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.boxplot(x<span class="op">=</span><span class="st">'Age'</span>, y<span class="op">=</span><span class="st">'Absenteeism time in hours'</span>, data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-183-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>The above box-plot confirms that the people aged 34 or 58 have highest number of <code>Absenteeism time in hours</code>.</p>
<div class="cell" data-execution_count="342">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>]<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">5</span>)</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.boxplot(x<span class="op">=</span><span class="st">'Son'</span>, y<span class="op">=</span><span class="st">'Absenteeism time in hours'</span>, data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Wk6_Intro-to-Exploratory-Data-Analysis_files/figure-html/cell-184-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>The people who have 2 sons have highest number of <code>Absenteeism time in hours</code>.</p>
<p><strong>Findings of multivariate analysis</strong></p>
<p>• <code>Month of absence</code> and <code>Seasons</code> are positively correlated (correlation coefficient = 0.41).</p>
<p>• <code>Body mass index</code> and <code>Service time</code> are positively correlated (correlation coefficient = 0.50).</p>
<p>• Smilarly, <code>Body mass index</code> and <code>Age</code> are positively correlated (correlation coefficient = 0.47).</p>
<p>• Also, <code>Body mass index</code> and <code>Weight</code> are highly positively correlated (correlation coefficient = 0.90).</p>
<p>• The pair plot confirms that there is strong positive correlation between <code>Service time</code> and <code>Age</code>.</p>
<p>• Similarly, <code>Distance from Residence to Work</code> and <code>Transportation expense</code> are positively correlated.</p>
<p>• There is a mildly positive correlation between <code>Absenteeism time in hours</code> and <code>Height</code>. Majority of data values lie below the fitted regression line.</p>
<p>• There is a weak correlation between <code>Absenteeism time in hours</code> and <code>Son</code>.</p>
<p>• There is a strong positive correlation between <code>Body mass index</code> and <code>Service time</code>. Approximately, half of the data values lie below the fitted regression line and half of the values lie above it.</p>
<p>• The people aged 34 or 58 have highest number of <code>Absenteeism time in hours</code>.</p>
<p>• The people who have 2 sons have highest number of <code>Absenteeism time in hours</code>.</p>
</section>
<section id="prediction-model-1" class="level3" data-number="11.6">
<h3 data-number="11.6" class="anchored" data-anchor-id="prediction-model-1"><span class="header-section-number">11.6</span> 6 Prediction Model</h3>
<p><u>A. Import the necessary libraries</u></p>
<div class="cell" data-execution_count="343">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, precision_score, recall_score, f1_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><u>B. Preprocess the data</u></p>
<div class="cell" data-execution_count="344">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into features and target</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">'Absenteeism time in hours'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'Absenteeism time in hours'</span>]</span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and testing sets</span></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the data</span></span>
<span id="cb295-9"><a href="#cb295-9" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb295-10"><a href="#cb295-10" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb295-11"><a href="#cb295-11" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> scaler.transform(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><u>C. Train and evaluate multiple algorithms</u></p>
<div class="cell" data-execution_count="349">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>log_reg <span class="op">=</span> LogisticRegression()</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>log_reg.fit(X_train, y_train)</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>y_pred_log_reg <span class="op">=</span> log_reg.predict(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="350">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision Tree</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>dt.fit(X_train, y_train)</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>y_pred_dt <span class="op">=</span> dt.predict(X_test)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="351">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>rf.fit(X_train, y_train)</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>y_pred_rf <span class="op">=</span> rf.predict(X_test)</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><u>D. Compare Performances</u></p>
<p>We can use various performance metrics such as accuracy, precision, recall, F1 score, and others.</p>
<pre><code>Accuracy: It is the proportion of correct predictions made by the model.

Precision: It is the number of true positive predictions out of all positive predictions made by the model.

Recall: It is the number of true positive predictions out of all actual positive instances.

F1 Score: It is the harmonic mean of precision and recall.</code></pre>
<p>We can calculate these metrics for each of the models, and based on the results, we can choose the one with the best performance.</p>
<p>However, it’s important to note that a model with a high accuracy score may not always be the best choice as it may be biased towards the majority class. Hence, it’s advisable to consider other metrics as well to get a comprehensive understanding of the model’s performance.</p>
<div class="cell" data-execution_count="353">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the performance metrics</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>acc_log_reg <span class="op">=</span> accuracy_score(y_test, y_pred_log_reg)</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>prec_log_reg <span class="op">=</span> precision_score(y_test, y_pred_log_reg, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a>rec_log_reg <span class="op">=</span> recall_score(y_test, y_pred_log_reg, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>f1_log_reg <span class="op">=</span> f1_score(y_test, y_pred_log_reg, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>acc_dt <span class="op">=</span> accuracy_score(y_test, y_pred_dt)</span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>prec_dt <span class="op">=</span> precision_score(y_test, y_pred_dt, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-9"><a href="#cb300-9" aria-hidden="true" tabindex="-1"></a>rec_dt <span class="op">=</span> recall_score(y_test, y_pred_dt, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-10"><a href="#cb300-10" aria-hidden="true" tabindex="-1"></a>f1_dt <span class="op">=</span> f1_score(y_test, y_pred_dt, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-11"><a href="#cb300-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-12"><a href="#cb300-12" aria-hidden="true" tabindex="-1"></a>acc_rf <span class="op">=</span> accuracy_score(y_test, y_pred_rf)</span>
<span id="cb300-13"><a href="#cb300-13" aria-hidden="true" tabindex="-1"></a>prec_rf <span class="op">=</span> precision_score(y_test, y_pred_rf, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-14"><a href="#cb300-14" aria-hidden="true" tabindex="-1"></a>rec_rf <span class="op">=</span> recall_score(y_test, y_pred_rf, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-15"><a href="#cb300-15" aria-hidden="true" tabindex="-1"></a>f1_rf <span class="op">=</span> f1_score(y_test, y_pred_rf, average<span class="op">=</span><span class="st">'weighted'</span>)</span>
<span id="cb300-16"><a href="#cb300-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-17"><a href="#cb300-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table to compare the performance of each algorithm</span></span>
<span id="cb300-18"><a href="#cb300-18" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb300-19"><a href="#cb300-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Algorithm"</span>: [<span class="st">"Logistic Regression"</span>, <span class="st">"Decision Tree"</span>, <span class="st">"Random Forest"</span>],</span>
<span id="cb300-20"><a href="#cb300-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Accuracy"</span>: [acc_log_reg, acc_dt, acc_rf],</span>
<span id="cb300-21"><a href="#cb300-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Precision"</span>: [prec_log_reg, prec_dt, prec_rf],</span>
<span id="cb300-22"><a href="#cb300-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Recall"</span>: [rec_log_reg, rec_dt, rec_rf],</span>
<span id="cb300-23"><a href="#cb300-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"F1-Score"</span>: [f1_log_reg, f1_dt, f1_rf]</span>
<span id="cb300-24"><a href="#cb300-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb300-25"><a href="#cb300-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-26"><a href="#cb300-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb300-27"><a href="#cb300-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Algorithm  Accuracy  Precision    Recall  F1-Score
0  Logistic Regression  0.459459   0.385260  0.459459  0.412607
1        Decision Tree  0.418919   0.452916  0.418919  0.432570
2        Random Forest  0.527027   0.511181  0.527027  0.518004</code></pre>
</div>
</div>
</section>
</section>
<section id="resources" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="resources"><span class="header-section-number">12</span> Resources</h2>
<p>It’s important to note that EDA is an iterative process and the steps may be repeated several times until a clear understanding of the data is obtained. The goal of EDA is to gain insights into the data and generate hypotheses for further investigation, rather than to develop a final model.</p>
<p>There are many resources available to learn Exploratory Data Analysis (EDA) in Python. Some of the most useful ones are:</p>
<pre><code>Books: "Python for Data Analysis" by Wes McKinney and "Data Science from Scratch" by Joel Grus are two popular books that cover the basics of EDA in Python.

Online courses: Coursera, Udemy, and EdX offer many online courses that cover EDA in Python, including "Applied Plotting, Charting &amp; Data Representation in Python" and "Data Visualization with Python."

Documentation and tutorials: The official documentation and tutorials for libraries such as Pandas, Matplotlib, and Seaborn provide in-depth explanations and examples of how to perform EDA in Python.

YouTube: There are many YouTube tutorials and presentations on EDA in Python that can help you get started with the basics.</code></pre>
<p>It’s also a good idea to practice EDA on real datasets as you learn. You can find many datasets on websites such as Kaggle, UCI Machine Learning Repository, and FiveThirtyEight.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>